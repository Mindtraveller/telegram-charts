function createButtons(e,n){const o=addClass(el("div"),"buttons");on(o,"click",function(t){const e=t.target.dataset.chart;if(!e)return;const o={...s,[e]:!s[e]};if(!Object.values(o).some(t=>t))return;t.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",s=o)});let s=Object.keys(e.names).reduce((t,e)=>({...t,[e]:!0}),{});return Object.keys(e.names).forEach(n=>{const s=el("button"),i=svgEl("svg",{width:"24",height:"24",viewBox:"0 0 24 24"});i.style.borderColor=e.colors[n],i.style.background=e.colors[n],add(i,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"})),add(s,i);const a=el("span");add(a,t(e.names[n])),add(s,a),s.dataset.chart=n,add(o,s)}),{buttons:o,visibilityMap:s}}function createChart(e){const n=document.getElementById("charts-container"),o=Math.min(500,window.innerWidth),s=400,i=Math.min(500,window.innerWidth),a=50,r=20,d=5,c=.95,l=10*o/500,u=e.columns[0].slice(1),f={...e,columns:e.columns.slice(1),lines:{}},h=Math.round(u.length/l/6),m=addClass(el("div"),"chart-wrapper"),g=svgEl("svg",{viewBox:`0 0 ${o} ${s+r}`}),{preview:v,previewContainer:p}=function(){const t=addClass(el("div"),"preview-container"),e=svgEl("svg",{viewBox:`0 0 ${i} ${a}`});return add(t,e),add(t,createSlider(f,m)),{previewContainer:t,preview:e}}();let{buttons:C,visibilityMap:w}=createButtons(f,m);const{selectedPointInfo:x,pointChartValues:E,pointDate:y}=function(){const e=el("div");addClass(e,"point-info");const n=el("div");addClass(n,"charts-info");const o=el("div");add(e,o),add(e,n);const s=Object.entries(f.names).reduce((e,[o,s])=>{const i=el("div");i.style.color=f.colors[o],addClass(i,"info");const a=el("span");return add(i,a),e[o]=a,add(i,t(s)),add(n,i),e},{});return{selectedPointInfo:e,pointChartValues:s,pointDate:o}}();let M,b,{xAxes:B,xAxesHidden:k}=function(){const t=svgEl("g");addClass(t,"x-axes");const e=svgEl("g");return addClass(e,"x-axes","hidden"),{xAxes:t,xAxesHidden:e}}();add(g,B),add(g,k),add(m,g),add(m,p),add(m,C),add(m,x),add(n,m);let A,N,$,I=0,D=void 0,L=-1,T=0,X=0,S=f.columns.filter(t=>w[t[0]]),_=K(),P=Q(u,i),j=F(S),H=q(S),O=tt(I,D),W=nt();function z(){if(j===T)return;const t=Math.ceil(j*c/(d-1)),e=Array.apply(null,Array(d-1)).map((e,n)=>(n+1)*t),n=U(e,st(e),s*c);Y(b),n.forEach((t,n)=>{const s=rt(10,o-10,t+r,t+r),i=dt(e[e.length-n-1],5,t);add(b,s),add(b,i)}),removeClass(b,"m-down","m-up"),removeClass(M,"m-down","m-up"),addClass(b,j>T?"m-up":"m-down","pending"),addClass(M,j>T?"m-down":"m-up","pending");const i=b;b=M,M=i,setTimeout(()=>{removeClass(M,"hidden","pending"),removeClass(b,"pending"),addClass(b,"hidden")},0)}function V(){if(A&&(g.removeChild(A),A=null),-1===L)return x.style.display="none",void f.columns.forEach(t=>{const e=t[0];f.lines[e].chartPoint.style.animationName="exit"});const t=u[L],e=o*(t-u[I])/(u[D-1]-u[I]);A=rt(e,e,r,r+s),f.columns.forEach(t=>{const n=t[0],o=t.slice(1),i=U(o,T,s,r),a=f.lines[n].chartPoint;a.style.animationName=w[n]?"enter":"exit",svgAttrs(a,{cx:e});const d=a.firstChild;svgAttrs(d,{from:d.getAttribute("to"),to:i[L]}),d.beginElement(),E[n].innerText=o[L],E[n].parentElement.style.display=w[n]?"flex":"none"}),g.insertBefore(A,g.firstChild),y.innerText=new Date(t).toString().slice(0,10);const n=e>o/2;x.style[n?"right":"left"]=`${n?o-e:e}px`,x.style[n?"left":"right"]=null,x.style.display="block"}function q(t){return st(t.reduce((t,e)=>t.concat(e.slice(1)),[]))}function F(t){return st(t.reduce((t,e)=>t.concat(e.slice(1+I,D?1+D:void 0)),[]))}function R(t=!1){S.forEach(e=>{const n=e[0],o=e.slice(1);J(f.lines[n],o),t&&G(f.lines[n],o)})}function G(t,e,n){const o=U(e,H,a),s=U(e,X,a);Z(t.preview,P,o,s,n)}function J(t,e,n){const o=e.slice(I,D),i=U(o,j,s,r),a=U(o,T,s,r);Z(t.chart,_,i,a,n)}function K(){return Q(u.slice(I,D),o)}function Q(t,e){const n=Math.min(...t),o=st(t),s=Math.abs(o-n);return t.map(t=>e*(t-n)/s)}function U(t,e,n,o=0){return t.map(t=>e?n*t/e+o:o)}function Y(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Z(t,e,n,o,s=1){const i=t.firstChild;svgAttrs(i,{from:e.reduce((t,e,n)=>t+`${e},${o[n]} `,""),to:e.reduce((t,e,o)=>t+`${e},${n[o]} `,"")}),t.style.animationName=s?"enter":"exit",i.beginElement()}function tt(t,e=u.length){const n=Math.round(10*(e-t)/u.length);return Math.round(Math.log2(n))}function et(){return Math.ceil(h*Math.pow(2,O))}function nt(){const t=[],e=et();for(let n=0;n<u.length;n+=e)t.push(ot(u[n]));return t}function ot(t){const e=new Date(t).toString().slice(4,10);return"0"===e[4]?`${e.slice(0,4)}${e[5]}`:e}function st(t){return Math.max(...t)}function it(t="points"){return svgEl("animate",{attributeName:t,repeatCount:1,dur:"250ms",fill:"freeze"})}function at(t,e){return svgEl("polyline",{fill:"none",stroke:t,"stroke-width":e})}function rt(t,e,n,o){return svgEl("line",{x1:t,y1:n,x2:e,y2:o,fill:"gray",stroke:"gray","stroke-width":.3})}function dt(t,e,n){const o=svgEl("text",{x:e,y:n});return o.textContent=t,o}S.forEach(t=>{const e=t[0],n=f.colors[e],o=at(n,2.5),s=at(n,1.5),i=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":2.5});i.style.animationName="exit",f.lines[e]={chart:o,preview:s,chartPoint:i},add(o,it()),add(s,it()),add(i,it("cy")),add(g,o),add(g,i),add(v,s)}),function(){const t=svgEl("g"),e=svgEl("g");addClass(t,"y-axes"),addClass(e,"y-axes","hidden"),g.insertBefore(t,g.firstChild),g.insertBefore(e,g.firstChild),g.insertBefore(function(){const t=svgEl("g"),e=rt(10,o-10,r,r),n=dt("0",5,-r);return add(t,e),add(t,n),t}(),g.firstChild),M=t,b=e}(),R(!0),z(),T=j,X=H,on(m,"visibility-updated",({detail:t})=>{N=t,$=f.columns.filter(t=>N[t[0]]),j=F($),H=q($),($.length>S.length?$:S).forEach(t=>{const e=t[0],n=t.slice(1),o=N[e]?1:0;J(f.lines[e],n,o),G(f.lines[e],n,o)}),z(),w=N,T=j,X=H,S=$,V()}),on(m,"border-changed",({detail:{start:t,end:e}})=>{const n=tt(t,e);n!==O&&(O=n,console.log(O),W=nt(),function(t,e,n,o){const s=t!==e,i=n!==o,a=n>o,r=B;B=k,k=r,addClass(B,"pending"),removeClass(B,"hidden","right"),addClass(k,"hidden"),removeClass(k,"pending","right"),!i||a||s||addClass(k,"right")}(I,t,D,e)),I=t,D=e,_=K(),j=F(S),R(),z(),function(){Y(B);const t=et();let e=1;for(;(I+e)%t!=0;)e++;for(let n=e;n<_.length-1;n+=t){const e=dt(W[(I+n)/t],_[n],0);add(B,e)}}(),T=j,V()}),on(g,"click",t=>{const e=t.offsetX,n=_[1]/2,o=I+Math.max(0,_.findIndex(t=>t+n>e));o!==L&&(L=o,V())}),on(document,"click",t=>{m.contains(t.target)||(L=-1,V())})}function el(t){return document.createElement(t)}function t(t){return document.createTextNode(t)}function svgEl(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return svgAttrs(n,e),n}function svgAttrs(t,e={}){Object.entries(e).forEach(([e,n])=>{t.setAttributeNS(null,e,n)})}function addClass(t,...e){return t.classList.add(...e),t}function removeClass(t,...e){t.classList.remove(...e)}function add(t,e){t.appendChild(e)}function on(t,e,n){t.addEventListener(e,n)}function off(t,e,n){t.removeEventListener(e,n)}function emit(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}(()=>{const t="Switch to Night Mode",e="Switch to Day Mode";let n=!1;const o=document.getElementById("mode-switcher");on(o,"click",function(){document.body.classList.toggle("dark-mode"),n=!n,o.innerText=n?e:t}),o.innerText=t})();const MIN_WIDTH=50;function createSlider(t,e){const n=t.columns[0].slice(1),{slider:o,leftBar:s,rightBar:i}=function(){const t=addClass(el("div"),"slider"),e=addClass(el("div"),"slider__bar"),n=addClass(el("div"),"slider__bar","right");return add(t,e),add(t,n),{slider:t,leftBar:e,rightBar:n}}(),a=A("left"),r=A("right");let d;on(s,"touchstart",C),on(s,"mousedown",C),on(o,"touchstart",g),on(o,"mousedown",g),on(i,"touchstart",C),on(i,"mousedown",C);let c,l,u,f=0,h=0,m={start:-1,end:-1};function g(t){u=t.touches?t.touches[0].clientX:t.clientX,on(t.target,"touchmove",v),on(t.target.parentElement,"mousemove",v),on(t.target,"touchend",p),window.onmouseup=(()=>p(t))}function v(t){t.preventDefault();const e=t.touches?t.touches[0].clientX:t.clientX,n=u-e,o=Math.max(0,c-n),s=Math.max(0,f+n);y(o,s)&&(M(o),b(s),k())}function p(t){E(),off(t.target,"touchmove",v),off(t.target.parentElement,"mousemove",v),off(t.target,"touchend",p),window.onmouseup=void 0}function C(t){u=t.touches?t.touches[0].clientX:t.clientX;const e=t.target===s;t.target.ontouchmove=(t=>w(t,e)),t.target.parentElement.parentElement.onmousemove=(t=>w(t,e)),on(t.target,"touchend",x),window.onmouseup=(()=>x(t)),t.stopPropagation()}function w(t,e){t.preventDefault();const n=t.touches?t.touches[0].clientX:t.clientX,o=u-n,s=e?Math.max(0,c-o):l,i=e?h:Math.max(0,f+o);y(s,i)&&(e?M(s):b(i),k())}function x(t){E(),t.target.onmousemove=void 0,t.target.parentElement.parentElement.onmousemove=void 0,off(t.target,"touchend",x),window.onmouseup=void 0}function E(){y()&&(f=h,c=l)}function y(t=l,e=h){return d-t-e>=MIN_WIDTH}function M(t){l=t,B(a,t)}function b(t){h=t,B(r,t)}function B(t,e){t.style.width=`${e}px`}function k(){const t={start:Math.max(0,Math.floor(l*n.length/d)),end:Math.min(n.length-1,Math.round((d-h)*n.length/d))};m.start===t.start&&m.end===t.end||(m=t,emit(e,"border-changed",t))}function A(t){return addClass(el("div"),"shadow",t)}requestAnimationFrame(()=>{d=o.parentElement.getBoundingClientRect().width,l=d-MIN_WIDTH,b(h),M(l),E(),k()});const N=addClass(el("div"),"slider-container");return add(N,a),add(N,o),add(N,r),N}