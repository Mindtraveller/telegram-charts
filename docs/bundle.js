function createBarChart(e,t){let n=Math.min(400,window.innerWidth),l=350,a=n-20,i=50,o=20,r=6,s=10*n/400,c=t.columns[0].slice(1),u={...t,columns:t.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},m=Math.round(c.length/s/6),h=svgEl("svg",{viewBox:`0 0 ${n} ${l+o}`}),f=createCanvas(n,l),{preview:g,previewContainer:v}=function(){let t=el("div","preview-container"),n=createCanvas(a,i);return add(t,n,createSlider(c,e)),{previewContainer:t,preview:n}}(),{selectedPointInfo:x,pointChartValues:p,pointDate:C}=createSelectedPointInfo(u),{xAxes:y,xAxesHidden:E}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:A,yAxesGroupHidden:w}=function(){let e=svgEl("g",{},"y-axes","text"),t=svgEl("g",{},"y-axes","text","hidden");return[e,t].forEach(e=>{for(let t=0;t<r;t++)add(e,q("",5,0))}),{yAxesGroupShown:e,yAxesGroupHidden:t}}(),D=el("div","charts");add(D,f,h,v,x),add(h,function(){let e=svgEl("g",{},"y-axes","lines"),t=Math.ceil(l/r);for(let a=0;a<r;a++){let i=createAxisLine(10,n-10,l-t*a,l-t*a);add(e,i)}return e}(),A,w,y,E),add(e,D);let M=0,B=c.length,b=-1,F=0,S=u.columns,T=_(),L=H(c,n),k=G(S),N=U(S.reduce((e,t)=>e.concat(t.data),[]));let O=V(M,B),P=K(O),z=null;function I(){if(-1===b||b<M||b>B)return void(x.style.display="none");let e=c[b],t=n*(e-c[M])/(c[B]-c[M]);j(u.columns,(e,t)=>{p[t].value.style.color=getTooltipColor(u.colors[t]),p[t].value.innerText=formatPointValue(e[b]),p[t].value.parentElement.style.display="flex"}),C.innerText=new Date(e).toString().slice(0,15);let l=t>n/2;x.style.transform="translateX("+(l?t-200:t+20)+"px)",x.style.display="block"}function G(e){return U(e.reduce((e,t)=>e.concat(t.data.slice(M,B+1)),[]))}function R(e=!1){j(S,(t,o)=>{!function(e,t){let a=customNormalize(t.slice(M,B+1),k,l),i=n/T.length;if(-1===b)return void $(getLineColor(e.color),T,a,i);if(b>=M&&b<=B)return $("#8cbef5",T.slice(0,b-M),a.slice(0,b-M),i),$("#8cbef5",T.slice(b-M+1),a.slice(b-M+1),i),void $("#558DED",[T[b-M]],[a[b-M]],i);$("#8cbef5",T,a,i)}(u.lines[o],t),e&&function(e,t,n){let l=customNormalize(t,N,i);o=e,r=L,s=l,drawBars(g,r,s,getLineColor(o.color),a/r.length);var o,r,s}(u.lines[o],t)})}function _(){return H(c.slice(M,B+1),n)}function H(e,t){let n=e[0],l=e[e.length-1],a=Math.abs(l-n);return e.map(e=>t*(e-n)/a)}function $(e,t,n,l){drawBars(f,t,n,e,l)}function V(e,t){let n=Math.round(10*(t-e)/c.length);return Math.round(Math.log2(n))}function X(e){return Math.ceil(m*Math.pow(2,e))}function K(e){let t=[],n=X(e);for(let e=0;e<c.length;e+=n)t.push(W(c[e]));return t}function W(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function j(e,t){e.forEach(e=>t(e.data,e.name))}function U(e){return Math.max(...e)}function q(e,t,n){let l=svgEl("text",{x:t,y:n,"font-size":13});return l.textContent=e,l}j(S,(e,t)=>{let n=u.colors[t];u.lines[t]={color:n}}),R(!0),on(e,"border-changed",({detail:{start:e,end:t}})=>{let a=V(e,t);if(a!==O&&(P=K(a),function(e,t,n,l,a,i){let o=a!==i;if(n===l||!o){let n=y;y=E,E=n,addClass(y,"pending",o?"right":"",t>e?"even":""),removeClass(y,o?"":"right",t>e?"":"even"),addClass(E,o?"right":""),removeClass(E,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(y,"hidden"),addClass(E,"hidden")},0)}}(O,a,M,e,B,t),O=a),clearCanvas(f),M=e,B=t,T=_(),k=G(S),R(),!z){let e=F;z=setTimeout(()=>{!function(e,t){if(t===e)return;let n=Math.ceil(t/r),a=Array.apply(null,Array(r)).map((e,t)=>t*n),i=customNormalize(a,t,l),o=w.childNodes;i.reverse().forEach((e,t)=>{let n=o[t];n.textContent=formatAxisValue(a[a.length-t-1]),svgAttrs(n,{x:5,y:l-e-5})}),removeClass(w,"m-down","m-up"),removeClass(A,"m-down","m-up"),addClass(w,t>e?"m-up":"m-down","pending"),addClass(A,t>e?"m-down":"m-up","pending");let s=w;w=A,A=s,setTimeout(()=>{removeClass(A,"hidden","pending"),removeClass(w,"pending"),addClass(w,"hidden")},0)}(e,k),z=null},250)}F=k,function(){clearChildren(y);let e=X(O),t=1;for(;(M+t)%e!=0;)t++;if((M+t)%(2*e)!=0){let a=(M+t-e)/(2*e),i=n*(c[a]-c[M])/(c[B]-c[M]),r=q(P[a],i,l+o-5);add(y,r)}for(let n=t;n<T.length-1;n+=e){let t=q(P[(M+n)/e],T[n],l+o-5);add(y,t)}}(),I()}),on(h,"click",e=>{let t=n/T.length,l=M+Math.max(0,T.findIndex(n=>n+t>e.offsetX));l!==b&&(b=l,clearCanvas(f),R(),I())}),on(d,"click",t=>{e.contains(t.target)||(b=-1,clearCanvas(f),R(),I())}),on(d,"mode-change",()=>{clearCanvas(f),clearCanvas(g),R(!0)})}function createBarStackedChart(e,t){let n=Math.min(400,window.innerWidth),l=350,a=n-20,i=50,o=150,r=.5,s=20,c=6,u=10*n/400,m=t.columns[0].slice(1),h={...t,columns:t.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},f=Math.round(m.length/u/6),g=svgEl("svg",{viewBox:`0 0 ${n} ${l+s}`}),v=createCanvas(n,l),{preview:x,previewContainer:p}=function(){let t=el("div","preview-container"),n=createCanvas(a,i);return add(t,n,createSlider(m,e)),{previewContainer:t,preview:n}}(),{buttons:C,visibilityMap:y}=createButtons(h,e),{selectedPointInfo:E,pointChartValues:A,pointDate:w}=createSelectedPointInfo(h),{xAxes:D,xAxesHidden:M}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:B,yAxesGroupHidden:b}=function(){let e=svgEl("g",{},"y-axes","text"),t=svgEl("g",{},"y-axes","text","hidden");return[e,t].forEach(e=>{for(let t=0;t<c;t++)add(e,de("",5,0))}),{yAxesGroupShown:e,yAxesGroupHidden:t}}(),F=el("div","charts");add(F,v,g,p,E),add(g,function(){let e=svgEl("g",{},"y-axes","lines"),t=Math.ceil(l/c);for(let a=0;a<c;a++){let i=l-t*a,o=createAxisLine(10,n-10,i,i);add(e,o)}return e}(),B,b,D,M),add(e,F,C);let S=0,T=m.length,L=-1,k=0,N=h.columns,O=Z(),P=ee(m,n),z=q(N),I=U(N),G=le(S,T),R=ie(G),_=null;re(N,(e,t)=>{let n=h.colors[t];h.lines[t]={color:n}});let H,$=j(N);J($);let V=I;function X(e,t){if(t===e)return;let n=Math.ceil(t/c),a=Array.apply(null,Array(c)).map((e,t)=>t*n),i=customNormalize(a,t,l),o=b.childNodes;i.reverse().forEach((e,t)=>{let n=o[t];n.textContent=formatAxisValue(a[a.length-t-1]),svgAttrs(n,{x:5,y:l-e-5})}),removeClass(b,"m-down","m-up"),removeClass(B,"m-down","m-up"),addClass(b,t>e?"m-up":"m-down","pending"),addClass(B,t>e?"m-down":"m-up","pending");let r=b;b=B,B=r,setTimeout(()=>{removeClass(B,"hidden","pending"),removeClass(b,"pending"),addClass(b,"hidden")},0)}function K(){if(-1===L||L<S||L>T)return void(E.style.display="none");let e=m[L],t=n*(e-m[S])/(m[T]-m[S]);re(h.columns,(e,t)=>{A[t].value.style.color=getTooltipColor(h.colors[t]),A[t].value.innerText=formatPointValue(e[L]),A[t].value.parentElement.style.display=y[t]?"flex":"none"}),w.innerText=new Date(e).toString().slice(0,15);let l=t>n/2;E.style.transform="translateX("+(l?t-200:t+20)+"px)",E.style.display="block"}function W(e){let t=e.reduce((e,t)=>(e[t.name]=[],e),{});for(let n=S;n<T+1;n++)for(let l=0;l<e.length;l++){let a=e[l],i=e[l-1],o=i?t[i.name][2*(n-S)]+t[i.name][2*(n-S)+1]:0,r=a.data[n];t[a.name].push(o),t[a.name].push(r)}return t}function j(e){let t=e.reduce((e,t)=>(e[t.name]=[],e),{});for(let n=0;n<m.length;n++)for(let l=0;l<e.length;l++){let a=e[l],i=e[l-1],o=i?t[i.name][2*n]+t[i.name][2*n+1]:0,r=a.data[n];t[a.name].push(o),t[a.name].push(r)}return t}function U(e){let t=[];for(let n=0;n<m.length;n++)t.push(e.reduce((e,t)=>e+t.data[n],0));return se(t)}function q(e){let t=[];for(let n=S;n<T+1;n++)t.push(e.reduce((e,t)=>e+t.data[n],0));return se(t)}function Y(e){re(N,(t,n)=>{Q(h.lines[n],e[n],z)})}function J(e){re(N,(t,n)=>{!function(e,t){let n=customNormalize(t,I,i);ne(getLineColor(e.color),P,n)}(h.lines[n],e[n])})}function Q(e,t,a){let i=customNormalize(t,a,l);if(width=n/(i.length/2),-1!==L)return L>=S&&L<=T?(te(getLineColor(e.color),O.slice(0,L-S),i.slice(0,2*L-2*S),width,r),te(getLineColor(e.color),O.slice(L-S+1),i.slice(2*L-2*S+2),width,r),void te(getLineColor(e.color),[O[L-S]],[i[2*L-2*S],i[2*L-2*S+1]],width)):void te(getLineColor(e.color),O,i,width,r);te(getLineColor(e.color),O,i,width)}function Z(){return ee(m.slice(S,T+1),n)}function ee(e,t){let n=e[0],l=e[e.length-1],a=Math.abs(l-n);return e.map(e=>t*(e-n)/a)}function te(e,t,n,l,a){drawStackedBars(v,t,n,e,l,a)}function ne(e,t,n){drawStackedBars(x,t,n,e,a/t.length)}function le(e,t){let n=Math.round(10*(t-e)/m.length);return Math.round(Math.log2(n))}function ae(e){return Math.ceil(f*Math.pow(2,e))}function ie(e){let t=[],n=ae(e);for(let e=0;e<m.length;e+=n)t.push(oe(m[e]));return t}function oe(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function re(e,t){e.forEach(e=>t(e.data,e.name))}function se(e){return Math.max(...e)}function de(e,t,n){let l=svgEl("text",{x:t,y:n,"font-size":13});return l.textContent=e,l}on(e,"visibility-updated",({detail:e})=>{y=e;let t=h.columns.filter(e=>y[e.name]),n=j(t);z=q(t),X(k,z),I=U(t),function(e,t,n,l,a,r){let s={},d=e.concat(t).filter(e=>{let t=s[e.name];return s[e.name]=!0,!t}).sort((e,t)=>e.name>t.name?-1:e.name===t.name?0:1);scheduleAnimation(e=>{clearCanvas(v),clearCanvas(x);for(let o=0;o<d.length;o++){let s=d[o].name,c=h.lines[s],u=!t.find(e=>e.name===s),m=!y[s],f=[];if(u){f=n[s].slice(0);for(let t=0;t<f.length-1;t+=2)f[t+1]=f[t+1]*e}else if(m){f=l[s].slice(0);for(let t=0;t<f.length-1;t+=2)f[t]=f[t]-f[t]*e,f[t+1]=f[t+1]*(1-e)}else{f=n[s].slice(0);let t=l[s];for(let n=0;n<f.length-1;n+=2)f[n]=t[n]+(f[n]-t[n])*e,f[n+1]=t[n+1]+(f[n+1]-t[n+1])*e}Q(c,f.slice(2*S,2*T+2),r+(a-r)*e);let g=customNormalize(f,r+(a-r)*e,i);ne(c.color,P,g)}},o)}(t,N,n,$,I,V),k=z,V=I,$=n,N=t,K()}),on(e,"border-changed",({detail:{start:e,end:t}})=>{let a=le(e,t);if(a!==G&&(R=ie(a),function(e,t,n,l,a,i){let o=a!==i;if(n===l||!o){let n=D;D=M,M=n,addClass(D,"pending",o?"right":"",t>e?"even":""),removeClass(D,o?"":"right",t>e?"":"even"),addClass(M,o?"right":""),removeClass(M,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(D,"hidden"),addClass(M,"hidden")},0)}}(G,a,S,e,T,t),G=a),clearCanvas(v),S=e,T=t,O=Z(),z=q(N),Y(H=W(N)),!_){let e=k;_=setTimeout(()=>{X(e,z),_=null},o)}k=z,function(){clearChildren(D);let e=ae(G),t=1;for(;(S+t)%e!=0;)t++;if((S+t)%(2*e)!=0){let a=(S+t-e)/(2*e),i=n*(m[a]-m[S])/(m[T]-m[S]),o=de(R[a],i,l+s-5);add(D,o)}for(let n=t;n<O.length-1;n+=e){let t=de(R[(S+n)/e],O[n],l+s-5);add(D,t)}}(),K()}),on(g,"click",e=>{let t=O[1]/2,n=S+Math.max(0,O.findIndex(n=>n+t>e.offsetX));n!==L&&(L=n,clearCanvas(v),Y(H=W(N)),K())}),on(d,"click",t=>{if(!e.contains(t.target)){let e=-1;e!==L&&(L=e,clearCanvas(v),Y(H=W(N)),K())}}),on(d,"mode-change",()=>{clearCanvas(v),clearCanvas(x),Y(H),J($)})}function createDoubleYLineChart(e,t){let n=Math.min(400,window.innerWidth),l=350,a=n-20,i=50,o=2,r=1,s=250,c=20,u=6,m=10*n/400,h=t.columns[0].slice(1),f={...t,columns:t.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},g=Math.round(h.length/m/6),v=svgEl("svg",{viewBox:`0 0 ${n} ${l+c}`}),x=createCanvas(n,l),{preview:p,previewContainer:C}=function(){let t=el("div","preview-container"),n=createCanvas(a,i);return add(t,n,createSlider(h,e)),{previewContainer:t,preview:n}}(),{buttons:y,visibilityMap:E}=createButtons(f,e),{selectedPointInfo:A,pointChartValues:w,pointDate:D}=createSelectedPointInfo(f),{xAxes:M,xAxesHidden:B}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:b,yAxesGroupHidden:F,yAxesRightGroupShown:S,yAxesRightGroupHidden:T}=function(){let e=svgEl("g",{},"y-axes"),n=svgEl("g",{},"y-axes","hidden");[e,n].forEach(e=>{for(let n=0;n<u;n++){let n=re("",5,0);svgAttrs(n,{fill:t.colors.y0}),add(e,n)}});let l=svgEl("g",{},"y-axes","m-right"),a=svgEl("g",{},"y-axes","m-right","hidden");return[l,a].forEach(e=>{for(let n=0;n<u;n++){let n=re("",5,0);svgAttrs(n,{fill:t.colors.y1}),add(e,n)}}),{yAxesGroupShown:e,yAxesGroupHidden:n,yAxesRightGroupShown:l,yAxesRightGroupHidden:a}}(),L=function(){let e=svgEl("g",{},"y-axes","lines"),t=Math.ceil(l/u);for(let a=0;a<u;a++){let i=createAxisLine(10,n-10,l-t*a,l-t*a);add(e,i)}return e}(),k=createAxisLine(0,0,0,l);addClass(k,"y-axes","lines");let N=el("div","charts");add(N,x,v,C,A),add(v,k,L,b,F,S,T,M,B),add(e,N,y);let O=0,P=h.length,z=-1,I=f.columns,G=Y(),R=J(h,n),_={y0:{min:0,max:0},y1:{min:0,max:0}},H=j(I);I.forEach(e=>e.yMax={max:ie(e.data),min:oe(e.data)});let $=ee(O,P),V=ne($),X=null;function K(e,t,a){ae(f.columns,(i,o)=>{let r="y1"===o,s=r?T:F,d=r?S:b;if(!E[o])return removeClass(d,"m-down"),void addClass(d,"hidden","m-up");if(e[o]&&t[o].max===e[o].max&&t[o].min===e[o].min&&a[o]&&E[o])return;let c=Math.ceil((t[o].max-t[o].min)/u),m=Array.apply(null,Array(u)).map((e,n)=>t[o].min+n*c),h=customNormalize(m,t[o].max,l,0,t[o].min).reverse(),f=F.childNodes,g=T.childNodes;if(h.forEach((e,t)=>{let a=r?g[t]:f[t];a.textContent=formatAxisValue(m[m.length-t-1]),svgAttrs(a,{x:r?n-7*(a.textContent.length+1):5,y:l-e-5})}),removeClass(s,"m-down","m-up"),removeClass(d,"m-down","m-up"),addClass(s,e[o]&&t[o].max>e[o].max?"m-up":"m-down","pending"),addClass(d,e[o]&&t[o].max>e[o].max?"m-down":"m-up","pending"),r){let e=T;T=S,S=e}else{F=b,b=s}setTimeout(()=>{removeClass(s,"hidden","pending"),removeClass(d,"pending"),addClass(d,"hidden")},0)})}function W(){if(-1===z||z<O||z>P)return k.style.display="none",A.style.display="none",void ae(f.columns,(e,t)=>{f.lines[t].chartPoint.style.animationName="exit"});let e=h[z],t=n*(e-h[O])/(h[P]-h[O]);svgAttrs(k,{x1:t,x2:t}),ae(f.columns,(e,n)=>{let a=customNormalize([e[z]],_[n].max,l,c,_[n].min)[0],i=f.lines[n].chartPoint;i.style.animationName=E[n]?"enter":"exit",svgAttrs(i,{cx:t});let o=i.firstChild;svgAttrs(o,{from:o.getAttribute("to"),to:a}),o.beginElement(),w[n].value.style.color=getTooltipColor(f.colors[n]),w[n].value.innerText=formatPointValue(e[z]),w[n].value.parentElement.style.display=E[n]?"flex":"none"}),D.innerText=new Date(e).toString().slice(0,15);let a=t>n/2;A.style.transform="translateX("+(a?t-200:t+20)+"px)",A.style.display="block",k.style.display="block"}function j(e){return e.reduce((e,t)=>{let n=t.data.slice(O,P+1);return e[t.name]={max:ie(n),min:oe(n)},e},{})}function U(){ae(I,(e,t,n)=>{!function(e,t,n,l){let a=customNormalize(t,n.max,i,0,n.min);Z(e,R,a,l)}(f.lines[t],e,n.yMax)})}function q(){ae(I,(e,t,n)=>{!function(e,t,n,a){let i=customNormalize(t.slice(O,P+1),n.max,l,0,n.min);Q(e,G,i,a)}(f.lines[t],e,H[t])})}function Y(){return J(h.slice(O,P+1),n)}function J(e,t){let n=e[0],l=e[e.length-1],a=Math.abs(l-n);return e.map(e=>t*(e-n)/a)}function Q(e,t,n,l=1){drawLine(x,t,n,getLineColor(e.color),l,o)}function Z(e,t,n,l=1){drawLine(p,t,n,getLineColor(e.color),l,r)}function ee(e,t){let n=Math.round(10*(t-e)/h.length);return Math.round(Math.log2(n))}function te(e){return Math.ceil(g*Math.pow(2,e))}function ne(e){let t=[],n=te(e);for(let e=0;e<h.length;e+=n)t.push(le(h[e]));return t}function le(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function ae(e,t){e.forEach(e=>t(e.data,e.name,e))}function ie(e){return Math.max(...e)}function oe(e){return Math.min(...e)}function re(e,t,n){let l=svgEl("text",{x:t,y:n,"font-size":13});return l.textContent=e,l}ae(I,(e,t)=>{let n=f.colors[t],l=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":o});l.style.animationName="exit",f.lines[t]={chartPoint:l,color:n},add(l,function(e="points"){return svgEl("animate",{attributeName:e,repeatCount:1,dur:"250ms",fill:"freeze",from:0,to:0})}("cy")),add(v,l)}),U(),on(e,"visibility-updated",({detail:e})=>{let t=E;E=e;let n=f.columns.filter(e=>E[e.name]);H=j(f.columns),function(e,t,n){let a=e.length>=I.length?e:t;scheduleAnimation(e=>{clearCanvas(x),clearCanvas(p),ae(a,(a,o,r)=>{let s=f.lines[o],d=1,c=i,u=l,m=!t.find(e=>e.name===o),h=!E[o];m?(d=Math.min(1,2*e),c*=1-e+1,u*=1-e+1):h&&(d=Math.max(0,1-2*e),u+=u*e,c+=c*e);let g=a.slice(O,P+1),v=customNormalize(g,n[o].max,u,0,n[o].min);Q(s,G,v,d);let x=customNormalize(a,r.yMax.max,c,0,r.yMax.min);Z(s,R,x,d)})},s)}(n,I,H),K(_,H,t),_=H,I=n,W()}),on(e,"border-changed",({detail:{start:e,end:t}})=>{let a=ee(e,t);if(a!==$&&(V=ne(a),function(e,t,n,l,a,i){let o=a!==i;if(n===l||!o){let n=M;M=B,B=n,addClass(M,"pending",o?"right":"",t>e?"even":""),removeClass(M,o?"":"right",t>e?"":"even"),addClass(B,o?"right":""),removeClass(B,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(M,"hidden"),addClass(B,"hidden")},0)}}($,a,O,e,P,t),$=a),clearCanvas(x),O=e,P=t,G=Y(),H=j(I),q(),!X){let e=_;X=setTimeout(()=>{K(e,H,E),X=null},s)}_=H,function(){clearChildren(M);let e=te($),t=1;for(;(O+t)%e!=0;)t++;if((O+t)%(2*e)!=0){let a=(O+t-e)/(2*e),i=n*(h[a]-h[O])/(h[P]-h[O]),o=re(V[a],i,l+c-5);add(M,o)}for(let n=t;n<G.length-1;n+=e){let t=re(V[(O+n)/e],G[n],l+c-5);add(M,t)}}(),W()}),on(v,"click",e=>{let t=G[1]/2,n=O+Math.max(0,G.findIndex(n=>n+t>e.offsetX));n!==z&&(z=n,W())}),on(d,"click",t=>{e.contains(t.target)||(z=-1,W())}),on(d,"mode-change",()=>{clearCanvas(x),clearCanvas(p),q(),U()})}function createLineChart(e,t){let n=Math.min(400,window.innerWidth),l=350,a=n-20,i=50,o=2,r=1,s=250,c=20,u=6,m=10*n/400,h=t.columns[0].slice(1),f={...t,columns:t.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},g=Math.round(h.length/m/6),v=svgEl("svg",{viewBox:`0 0 ${n} ${l+c}`}),x=createCanvas(n,l),{preview:p,previewContainer:C}=function(){let t=el("div","preview-container"),n=createCanvas(a,i);return add(t,n,createSlider(h,e)),{previewContainer:t,preview:n}}(),{buttons:y,visibilityMap:E}=createButtons(f,e),{selectedPointInfo:A,pointChartValues:w,pointDate:D}=createSelectedPointInfo(f),{xAxes:M,xAxesHidden:B}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:b,yAxesGroupHidden:F}=function(){let e=svgEl("g",{},"y-axes","text"),t=svgEl("g",{},"y-axes","text","hidden");return[e,t].forEach(e=>{for(let t=0;t<u;t++)add(e,ue("",5,0))}),{yAxesGroupShown:e,yAxesGroupHidden:t}}(),S=createAxisLine(0,0,0,l);addClass(S,"y-axes","lines");let T=el("div","charts");add(T,x,v,C,A),add(v,S,function(){let e=svgEl("g",{},"y-axes","lines"),t=Math.ceil(l/u);for(let a=0;a<u;a++){let i=createAxisLine(10,n-10,l-t*a,l-t*a);add(e,i)}return e}(),b,F,M,B),add(e,T,y);let L=0,k=h.length,N=-1,O=0,P=0,z=0,I=0,G=f.columns,R=ee(),_=te(h,n),{max:H,min:$}=J(G),{max:V,min:X}=Y(G),K=ae(L,k),W=oe(K),j=null;function U(e,t,n,a){if(t===e&&n===a)return;let i=Math.ceil((t-a)/u),o=Array.apply(null,Array(u)).map((e,t)=>a+t*i),r=customNormalize(o,t,l,0,a),s=F.childNodes;r.reverse().forEach((e,t)=>{let n=s[t];n.textContent=formatAxisValue(o[o.length-t-1]),svgAttrs(n,{x:5,y:l-e-5})}),removeClass(F,"m-down","m-up"),removeClass(b,"m-down","m-up"),addClass(F,t>e?"m-up":"m-down","pending"),addClass(b,t>e?"m-down":"m-up","pending");let d=F;F=b,b=d,setTimeout(()=>{removeClass(b,"hidden","pending"),removeClass(F,"pending"),addClass(F,"hidden")},0)}function q(){if(-1===N||N<L||N>k)return S.style.display="none",A.style.display="none",void se(f.columns,(e,t)=>{f.lines[t].chartPoint.style.animationName="exit"});let e=h[N],t=n*(e-h[L])/(h[k]-h[L]);svgAttrs(S,{x1:t,x2:t}),se(f.columns,(e,n)=>{let a=customNormalize([e[N]],P,l,c,O)[0],i=f.lines[n].chartPoint;i.style.animationName=E[n]?"enter":"exit",svgAttrs(i,{cx:t});let o=i.firstChild;svgAttrs(o,{from:o.getAttribute("to"),to:a}),o.beginElement(),w[n].value.style.color=getTooltipColor(f.colors[n]),w[n].value.innerText=formatPointValue(e[N]),w[n].value.parentElement.style.display=E[n]?"flex":"none"}),D.innerText=new Date(e).toString().slice(0,15);let a=t>n/2;A.style.transform="translateX("+(a?t-200:t+20)+"px)",A.style.display="block",S.style.display="block"}function Y(e){let t=e.reduce((e,t)=>e.concat(t.data),[]);return{max:de(t),min:ce(t)}}function J(e){let t=e.reduce((e,t)=>e.concat(t.data.slice(L,k+1)),[]);return{max:de(t),min:ce(t)}}function Q(){se(G,(e,t)=>{!function(e,t,n){let a=customNormalize(t.slice(L,k+1),H,l,0,$);ne(e,R,a,n)}(f.lines[t],e)})}function Z(){se(G,(e,t)=>{!function(e,t,n){let l=customNormalize(t,V,i,0,X);le(e,_,l,n)}(f.lines[t],e)})}function ee(){return te(h.slice(L,k+1),n)}function te(e,t){let n=e[0],l=e[e.length-1],a=Math.abs(l-n);return e.map(e=>t*(e-n)/a)}function ne(e,t,n,l=1){drawLine(x,t,n,getLineColor(e.color),l,o)}function le(e,t,n,l=1){drawLine(p,t,n,getLineColor(e.color),l,r)}function ae(e,t){let n=Math.round(10*(t-e)/h.length);return Math.round(Math.log2(n))}function ie(e){return Math.ceil(g*Math.pow(2,e))}function oe(e){let t=[],n=ie(e);for(let e=0;e<h.length;e+=n)t.push(re(h[e]));return t}function re(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function se(e,t){e.forEach(e=>t(e.data,e.name))}function de(e){return Math.max(...e)}function ce(e){return Math.min(...e)}function ue(e,t,n){let l=svgEl("text",{x:t,y:n,"font-size":13});return l.textContent=e,l}se(G,(e,t)=>{let n=f.colors[t],l=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":o});l.style.animationName="exit",f.lines[t]={chartPoint:l,color:n},add(l,function(e="points"){return svgEl("animate",{attributeName:e,repeatCount:1,dur:"250ms",fill:"freeze",from:0,to:0})}("cy")),add(v,l)}),Z(),I=V,z=X,on(e,"visibility-updated",({detail:e})=>{E=e;let t=f.columns.filter(e=>E[e.name]),{max:n,min:a}=J(t),{max:o,min:r}=Y(t);!function(e,t,n,a,i,o){let r=n-a,d=i-o,c=e.length>=G.length?e:t;scheduleAnimation(e=>{clearCanvas(x),se(c,(n,i)=>{let s=f.lines[i],c=1;t.find(e=>e.name===i)?E[i]||(c=Math.max(0,1-2*e)):c=Math.min(1,2*e);let u=n.slice(L,k+1),m=customNormalize(u,a+r*e,l,0,o+d*e);ne(s,R,m,c)})},s)}(t,G,n,P,a,O),function(e,t,n,l,a,o){let r=n-l,d=a-o,c=e.length>=G.length?e:t;scheduleAnimation(e=>{clearCanvas(p),se(c,(n,a)=>{let s=f.lines[a],c=1;t.find(e=>e.name===a)?E[a]||(c=Math.max(0,1-2*e)):c=Math.min(1,2*e);let u=customNormalize(n,l+r*e,i,0,o+d*e);le(s,_,u,c)})},s)}(t,G,o,I,r,z),U(P,n,O,a),P=n,O=a,I=o,z=r,G=t,q()}),on(e,"border-changed",({detail:{start:e,end:t}})=>{let a=ae(e,t);a!==K&&(W=oe(a),function(e,t,n,l,a,i){let o=a!==i;if(n===l||!o){let n=M;M=B,B=n,addClass(M,"pending",o?"right":"",t>e?"even":""),removeClass(M,o?"":"right",t>e?"":"even"),addClass(B,o?"right":""),removeClass(B,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(M,"hidden"),addClass(B,"hidden")},0)}}(K,a,L,e,k,t),K=a),clearCanvas(x),L=e,k=t,R=ee();let i=J(G);if($=i.min,H=i.max,Q(),!j){let e=P,t=O;j=setTimeout(()=>{U(e,H,t,$),j=null},s)}P=H,O=$,function(){clearChildren(M);let e=ie(K),t=1;for(;(L+t)%e!=0;)t++;if((L+t)%(2*e)!=0){let a=(L+t-e)/(2*e),i=n*(h[a]-h[L])/(h[k]-h[L]),o=ue(W[a],i,l+c-5);add(M,o)}for(let n=t;n<R.length-1;n+=e){let t=ue(W[(L+n)/e],R[n],l+c-5);add(M,t)}}(),q()}),on(v,"click",e=>{let t=R[1]/2,n=L+Math.max(0,R.findIndex(n=>n+t>e.offsetX));n!==N&&(N=n,q())}),on(d,"click",t=>{e.contains(t.target)||(N=-1,q())}),on(d,"mode-change",()=>{clearCanvas(x),clearCanvas(p),Q(),Z()})}function createPercentageStackedAreaChart(e,t){let n=Math.min(400,window.innerWidth),l=350,a=20,i=n-20,o=50,r=150,s=20,c=5,u=10*n/400,m=t.columns[0].slice(1),h={...t,columns:t.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},f=Math.round(m.length/u/6),g=svgEl("svg",{viewBox:`0 0 ${n} ${l+s}`}),v=createCanvas(n,l),{preview:x,previewContainer:p}=function(){let t=el("div","preview-container"),n=createCanvas(i,o);return add(t,n,createSlider(m,e)),{previewContainer:t,preview:n}}(),{buttons:C,visibilityMap:y}=createButtons(h,e),{selectedPointInfo:E,pointChartValues:A,pointDate:w}=createSelectedPointInfo(h),{xAxes:D,xAxesHidden:M}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:B,yAxesGroupHidden:b}=function(){let e=svgEl("g",{},"y-axes","text","m-up");e.style.opacity="0";for(let t=0;t<c;t++){let t=Q("",5,0);add(e,t)}return{yAxesGroupHidden:e}}(),F=createAxisLine(0,0,0,l);addClass(F,"y-axes","lines");let S=el("div","charts");add(S,v,g,p,E),add(g,F,function(){let e=svgEl("g",{},"y-axes","lines"),t=Math.ceil((l-a)/(c-1));for(let a=0;a<c;a++){let i=l-t*a,o=createAxisLine(10,n-10,i,i);add(e,o)}return e}(),B,b,D,M),add(e,S,C);let T=0,L=m.length,k=-1,N=h.columns,O=K(),P=W(m,n),z=j(T,L),I=q(z);J(N,(e,t)=>{let n=h.colors[t];h.lines[t]={color:n}});let G=_(N);function R(){if(-1===k||k<T||k>L)return F.style.display="none",void(E.style.display="none");let e=m[k],t=n*(e-m[T])/(m[L]-m[T]);svgAttrs(F,{x1:t,x2:t});let l=h.columns.reduce((e,t)=>e+(y[t.name]?t.data[k]:0),0);J(h.columns,(e,t)=>{A[t].subValue.innerText=Math.round(e[k]/l*100)+"%",A[t].value.style.color=getTooltipColor(h.colors[t]),A[t].value.innerText=formatPointValue(e[k]),A[t].value.parentElement.style.display=y[t]?"flex":"none"}),w.innerText=new Date(e).toString().slice(0,15);let a=t>n/2;E.style.transform="translateX("+(a?t-200:t+20)+"px)",E.style.display="block",F.style.display="block"}function _(e){let t=e.reduce((e,t)=>(e[t.name]=[],e),{});for(let n=0;n<m.length;n++){let l=e.reduce((e,t)=>e+t.data[n],0);for(let a=0;a<e.length;a++){let i=e[a],o=e[a-1],r=e[a+1],s=o?t[o.name][2*n+1]:0,d=r?s+i.data[n]/l:1;t[i.name].push(s),t[i.name].push(d)}}return t}function H(e){J(N,(t,n)=>{X(h.lines[n],e[n])})}function $(e){J(N,(t,n)=>{V(h.lines[n],e[n])})}function V(e,t){let n=customNormalize(t,1,o);!function(e,t,n){drawStackedArea(x,t,n,getLineColor(e.color))}(e,P,n)}function X(e,t){let n=customNormalize(t.slice(2*T,2*L+2),1,l-a);drawStackedArea(v,O,n,getLineColor(e.color))}function K(){return W(m.slice(T,L+1),n)}function W(e,t){let n=e[0],l=e[e.length-1],a=Math.abs(l-n);return e.map(e=>t*(e-n)/a)}function j(e,t){let n=Math.round(10*(t-e)/m.length);return Math.round(Math.log2(n))}function U(e){return Math.ceil(f*Math.pow(2,e))}function q(e){let t=[],n=U(e);for(let e=0;e<m.length;e+=n)t.push(Y(m[e]));return t}function Y(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function J(e,t){e.forEach(e=>t(e.data,e.name))}function Q(e,t,n){let l=svgEl("text",{x:t,y:n,"font-size":13});return l.textContent=e,l}$(G),function(){let e=Math.ceil(100/(c-1)),t=Array.apply(null,Array(c)).map((t,n)=>n*e),n=customNormalize(t,100,l-a).reverse(),i=b.childNodes;n.forEach((e,n)=>{let a=i[n];a.textContent=formatAxisValue(t[t.length-n-1]),svgAttrs(a,{x:5,y:l-e-5})}),b.style.transition="0s",addClass(b,"m-up");let o=b;b=B,B=o,setTimeout(()=>{B.style.transition=null,B.style.opacity=null},0)}(),on(e,"visibility-updated",({detail:e})=>{y=e;let t=h.columns.filter(e=>y[e.name]),n=_(t);!function(e,t,n,l){let a={},i=e.concat(t).filter(e=>{let t=a[e.name];return a[e.name]=!0,!t}).sort((e,t)=>e.name>t.name?1:e.name===t.name?0:-1);scheduleAnimation(e=>{clearCanvas(v),clearCanvas(x);for(let a=0;a<i.length;a++){let o=i[a].name,r=h.lines[o],s=!t.find(e=>e.name===o),d=!y[o],c=i[a-1],u=i[a+1],m=[];if(s){let t=c?n[c.name]:null,a=c?l[c.name]:null,i=u?n[u.name]:null,r=u?l[u.name]:null;m=n[o].slice(0);for(let n=0;n<m.length-1;n+=2)m[n]=t?a[n+1]+(t[n+1]-a[n+1])*e:a?a[n+1]*(1-e):0,m[n+1]=i?r[n]+(i[n]-r[n])*e:a&&!t?1:t?1:e}else if(d){let t=c?n[c.name]:null,a=c?l[c.name]:null,i=u?n[u.name]:null,r=u?l[u.name]:null;m=l[o].slice(0);for(let n=0;n<m.length-1;n+=2)m[n]=a&&t?a[n+1]+(t[n+1]-a[n+1])*e:t?t[n+1]*e:i?m[n]*(1-e):m[n]+(1-m[n])*e,m[n+1]=r&&i?r[n]+(i[n]-(r[n]||1))*e:i?1-e:1}else{m=n[o].slice(0);let t=l[o];for(let n=0;n<m.length-1;n+=2)m[n]=t[n]+(m[n]-t[n])*e,m[n+1]=t[n+1]+(m[n+1]-t[n+1])*e}X(r,m),V(r,m)}},r)}(t,N,n,G),G=n,N=t,R()}),on(e,"border-changed",({detail:{start:e,end:t}})=>{let a=j(e,t);a!==z&&(I=q(a),function(e,t,n,l,a,i){let o=a!==i;if(n===l||!o){let n=D;D=M,M=n,addClass(D,"pending",o?"right":"",t>e?"even":""),removeClass(D,o?"":"right",t>e?"":"even"),addClass(M,o?"right":""),removeClass(M,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(D,"hidden"),addClass(M,"hidden")},0)}}(z,a,T,e,L,t),z=a),clearCanvas(v),T=e,L=t,O=K(),H(G),function(){clearChildren(D);let e=U(z),t=1;for(;(T+t)%e!=0;)t++;if((T+t)%(2*e)!=0){let a=(T+t-e)/(2*e),i=n*(m[a]-m[T])/(m[L]-m[T]),o=Q(I[a],i,l+s-5);add(D,o)}for(let n=t;n<O.length-1;n+=e){let t=Q(I[(T+n)/e],O[n],l+s-5);add(D,t)}}(),R()}),on(g,"click",e=>{let t=O[1]/2,n=T+Math.max(0,O.findIndex(n=>n+t>e.offsetX));n!==k&&(k=n,R())}),on(d,"click",t=>{e.contains(t.target)||(k=-1,R())}),on(d,"mode-change",()=>{clearCanvas(v),clearCanvas(x),H(G),$(G)})}function scheduleAnimation(e,t){let n=performance.now();requestAnimationFrame(function l(a){let i=Math.min(1,Math.max(0,a-n)/t);i<1&&requestAnimationFrame(l),e(i)})}function createCanvas(e,t){let n=el("canvas");return n.width=e,n.height=t,n.getContext("2d").setTransform(1,0,0,-1,0,t),n}function clearCanvas(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}function drawLine(e,t,n,l,a=1,i=1){let o=e.getContext("2d");o.beginPath(),o.globalAlpha=a,o.strokeStyle=l,o.lineWidth=i,o.moveTo(Math.round(t[0]),Math.round(n[0]));for(let e=1;e<t.length;e++)o.lineTo(Math.round(t[e]),Math.round(n[e]));o.stroke()}function drawBars(e,t,n,l,a){let i=e.getContext("2d");i.beginPath(),i.fillStyle=l;for(let e=0;e<t.length;e++)i.rect(t[e],0,Math.ceil(a),Math.round(n[e]));i.fill()}function drawStackedArea(e,t,n,l){let a=e.getContext("2d");a.beginPath(),a.fillStyle=l,a.strokeStyle=l,a.lineWidth=1,a.moveTo(Math.round(t[0]),Math.floor(n[0]));for(let e=1;e<t.length;e++)a.lineTo(Math.round(t[e]),Math.floor(n[2*e]));for(let e=t.length-1;e>=0;e--)a.lineTo(Math.round(t[e]),Math.ceil(n[2*e+1]));a.fill()}function drawStackedBars(e,t,n,l,a,i=1){let o=e.getContext("2d");o.beginPath(),a=Math.ceil(a),o.fillStyle=l,o.globalAlpha=i;for(let e=0;e<t.length;e++)o.rect(t[e],n[2*e],a,n[2*e+1]);o.fill()}function createSelectedPointInfo(e){let n=el("div","point-info"),l=el("div","charts-info"),a=el("div");return add(n,a,l),{selectedPointInfo:n,pointChartValues:Object.entries(e.names).reduce((e,[n,a])=>{let i=el("div","info"),o=el("span"),r=el("span");e[n]={value:o,subValue:r};let s=el("span","name");return add(s,t(a)),add(i,r,s,o),add(l,i),e},{}),pointDate:a}}function createAxisLine(e,t,n,l){return svgEl("line",{x1:e,y1:n,x2:t,y2:l,"stroke-width":1})}function getLineColor(e){return isDark?LINE_DARK_COLORS[e]:LINE_COLORS[e]}function getButtonColor(e){return isDark?BUTTON_DARK_COLORS[e]:BUTTON_COLORS[e]}function getTooltipColor(e){return isDark?TOOLTIP_DARK_COLORS[e]:TOOLTIP_COLORS[e]}const BUTTON_COLORS={"#FE3C30":"#E65850","#4BD964":"#5FB641","#108BE3":"#3497ED","#E8AF14":"#F5BD25","#3497ED":"#3497ED","#2373DB":"#3381E8","#9ED448":"#9ED448","#5FB641":"#5FB641","#F5BD25":"#F5BD25","#F79E39":"#F79E39","#E65850":"#E65850"},BUTTON_DARK_COLORS={"#FE3C30":"#CF5D57","#4BD964":"#5AB34D","#108BE3":"#4681BB","#E8AF14":"#C9AF4F","#3497ED":"#4681BB","#2373DB":"#466FB3","#9ED448":"#88BA52","#5FB641":"#3DA05A","#F5BD25":"#F5BD25","#F79E39":"#D49548","#E65850":"#CF5D57"},TOOLTIP_COLORS={"#FE3C30":"#F34C44","#4BD964":"#3CC23F","#108BE3":"#108BE3","#E8AF14":"#E4AE1B","#64ADED":"#3896E8","#3497ED":"#108BE3","#2373DB":"#2373DB","#9ED448":"#89C32E","#5FB641":"#4BAB29","#F5BD25":"#EAAF10","#F79E39":"#F58608","#E65850":"#F34C44"},TOOLTIP_DARK_COLORS={"#FE3C30":"#F7655E","#4BD964":"#4BD964","#108BE3":"#108BE3","#E8AF14":"#DEB93F","#64ADED":"#4082CE","#3497ED":"#5199DF","#2373DB":"#3E65CF","#9ED448":"#99CF60","#5FB641":"#3CB560","#F5BD25":"#DBB630","#F79E39":"#EE9D39","#E65850":"#F7655E"},LINE_COLORS={"#FE3C30":"#FE3C30","#4BD964":"#4BD964","#108BE3":"#108BE3","#E8AF14":"#E8AF14","#64ADED":"#64ADED","#3497ED":"#3497ED","#2373DB":"#2373DB","#9ED448":"#9ED448","#5FB641":"#5FB641","#F5BD25":"#F5BD25","#F79E39":"#F79E39","#E65850":"#E65850"},LINE_DARK_COLORS={"#FE3C30":"#E6574F","#4BD964":"#4BD964","#108BE3":"#108BE3","#E8AF14":"#DEB93F","#64ADED":"#4082CE","#3497ED":"#4681BB","#2373DB":"#345B9C","#9ED448":"#88BA52","#5FB641":"#3DA05A","#F5BD25":"#D9B856","#F79E39":"#D49548","#E65850":"#CF5D57"};function isTouchDevice(){return"ontouchstart"in d.documentElement}let d=document;function el(e,...t){return addClass(d.createElement(e),...t)}function t(e){return d.createTextNode(e)}function svgEl(e,t,...n){let l=d.createElementNS("http://www.w3.org/2000/svg",e);return svgAttrs(l,t),addClass(l,...n)}function svgAttrs(e,t={}){Object.entries(t).forEach(([t,n])=>{e.setAttributeNS(null,t,n)})}function addClass(e,...t){return e.classList.add(...t.filter(e=>e)),e}function removeClass(e,...t){e.classList.remove(...t.filter(e=>e))}function add(e,...t){t.filter(e=>!!e).forEach(t=>e.appendChild(t))}function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function emit(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:n}))}function applyAnimation(e,t,n=250){e.style.animationName=t,setTimeout(()=>{e.style.animationName=null},n)}function clearChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function customNormalize(e,t,n,l=0,a=0){let i=e.slice(0);for(let o=0;o<e.length;o++)i[o]=Math.round(t?n*(i[o]-a)/(t-a)+l:l);return i}function formatAxisValue(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e}function formatPointValue(e){let t="",n=e.toString();for(let e=0;e<n.length/3;e++)t=n.slice(Math.max(0,n.length-3*e-3),n.length-3*e)+" "+t;return t}function createButtons(e,n){let l=300,a=null,i=[],o=el("div","buttons");on(o,isTouchDevice()?"touchstart":"mousedown",function(e){let t=e.target.dataset.chart;if(!t)return;on(o,isTouchDevice()?"touchend":"mouseup",c),a=setTimeout(()=>{!function(e){a=null,r={[e]:!0},[...o.childNodes].forEach(e=>r[e.dataset.chart]?removeClass(e,"m-hidden"):addClass(e,"m-hidden")),emit(n,"visibility-updated",r)}(t)},l)}),on(d,"mode-change",()=>{i.forEach(s)});let r=Object.keys(e.names).reduce((e,t)=>({...e,[t]:!0}),{});function s(e){const t=getButtonColor([e.color]);e.button.style.borderColor=t,e.div.style.background=t,e.span.style.color=t}function c(e){off(o,isTouchDevice()?"touchend":"mouseup",c),a&&(clearTimeout(a),a=null,function(e){let t=e.target,l=t.dataset.chart;if(!l)return;let a={...r,[l]:!r[l]};if(!Object.values(a).some(e=>e))return void applyAnimation(t,"shake",800);e.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",r=a)}(e))}return Object.keys(e.names).forEach(n=>{let l=el("button"),a=el("div"),r=el("span");i.push({button:l,div:a,span:r,color:e.colors[n]}),s({button:l,div:a,span:r,color:e.colors[n]}),add(l,a);let d=svgEl("svg",{width:"18",height:"18",viewBox:"0 0 24 24"});add(d,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"})),add(r,t(e.names[n])),add(l,d,r),l.dataset.chart=n,add(o,l)}),{buttons:o,visibilityMap:r}}function createChart(e,n){let l=d.getElementById("charts-container"),a=el("div","chart-wrapper"),i=el("div","chart-info"),o=el("h1"),r=el("div","selected-range"),s=el("div","range-from"),c=el("span","range-to");add(r,s,t(" - "),c),add(o,t("Chart #"+n)),add(i,o,r),add(a,i),e.y_scaled?createDoubleYLineChart(a,e):"bar"!==e.types.y0||e.stacked?"area"===e.types.y0?(addClass(a,"bar-chart"),createPercentageStackedAreaChart(a,e)):"bar"===e.types.y0&&e.stacked?(addClass(a,"bar-chart"),createBarStackedChart(a,e)):createLineChart(a,e):(addClass(a,"bar-chart"),createBarChart(a,e)),add(l,a);let u=null,m=e.columns[0].slice(1),h=-1,f=-1,g=-1,v=-1;on(a,"border-changed",({detail:{start:e,end:t}})=>{g=e,v=t,u||(u=setTimeout(()=>{u=null,g!==h&&(h=g,s.textContent=p(m[h]),applyAnimation(s,"time-change")),v!==f&&(f=v,c.textContent=p(m[f]),applyAnimation(c,"time-change"))},250))});let x=new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"long",year:"numeric"});function p(e){return x.format(new Date(e))}}let isDark=!1;function createSlider(e,t){let n,l=50,{slider:a,leftBar:i,rightBar:o}=function(){let e=el("div","slider"),t=el("div","slider__bar","left"),n=el("div","slider__bar","right");return{slider:e,leftBar:t,rightBar:n}}(),r=el("div","shadow","left"),s=el("div","shadow","right");on(t,"mousedown",v),on(t,"touchstart",v);let c,u,m,h=0,f=0,g={start:-1,end:-1};function v(e){let n=e.target,l=n===a?x:n===i||n===o?e=>(function(e,t){e.preventDefault();let n=C(e),l=m-n,a=t?Math.max(0,c-l):u,i=t?f:Math.max(0,h+l);y(a,i)&&(t?E(a):A(i),D())})(e,n===i):void 0;if(!l)return;m=C(e);let r=()=>{p(),off(t,"mousemove",l),off(t,"touchmove",l),off(d,"mouseup",r),off(d,"touchend",r)};on(t,"mousemove",l),on(t,"touchmove",l),on(d,"mouseup",r),on(d,"touchend",r)}function x(e){e.preventDefault();let t=C(e),n=m-t,l=c-n,a=h+n;y(l,a)&&(E(l),A(a),D())}function p(){y(u,f)&&(c=u,h=f)}function C(e){return e.touches?e.touches[0].clientX:e.clientX}function y(e,t){return e>=0&&t>=0&&n-e-t>=l}function E(e){u=e,w(r,e)}function A(e){f=e,w(s,e)}function w(e,t){e.style.width=`${t}px`}function D(){let l={start:Math.max(0,Math.round(u*e.length/n)),end:Math.min(e.length-1,Math.round((n-f)*(e.length-1)/n))};g.start===l.start&&g.end===l.end||(g=l,emit(t,"border-changed",l))}requestAnimationFrame(()=>{n=a.parentElement.getBoundingClientRect().width,u=n-l,A(f),E(u),p(),D()});let M=el("div","slider-container");return add(M,r,i,a,o,s),M}(()=>{let e="Switch to Night Mode",t="Switch to Day Mode",n=d.getElementById("mode-switcher");on(n,"click",function(){d.body.classList.toggle("dark"),isDark=!isDark,n.innerText=isDark?t:e,emit(d,"mode-change",{isDark:isDark})}),n.innerText=e})();