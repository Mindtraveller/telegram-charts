function createButtons(e,n){let i=el("div","buttons");on(i,"click",function(e){let t=e.target.dataset.chart;if(!t)return;let i={...l,[t]:!l[t]};if(!Object.values(i).some(e=>e))return;e.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",l=i)});let l=Object.keys(e.names).reduce((e,t)=>({...e,[t]:!0}),{});return Object.keys(e.names).forEach(n=>{let l=el("button"),r=svgEl("svg",{width:"20",height:"20",viewBox:"0 0 24 24"});r.style.borderColor=e.colors[n],r.style.background=e.colors[n],add(r,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}));let o=el("span");add(o,t(e.names[n])),add(l,r,o),l.dataset.chart=n,add(i,l)}),{buttons:i,visibilityMap:l}}function createChart(e){let n=d.getElementById("charts-container"),i=Math.min(500,window.innerWidth),l=400,r=50,o=2.5,s=1.5,a=20,u=5,c=.95,f=10*i/500,h=e.columns[0].slice(1),m={...e,columns:e.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},g=Math.round(h.length/f/6),v=el("div","chart-wrapper"),p=svgEl("svg",{viewBox:`0 0 ${i} ${l+a}`}),{preview:x,previewContainer:y}=function(){let e=el("div","preview-container"),t=svgEl("svg",{viewBox:`0 0 ${i} ${r}`});return add(e,t,createSlider(h,v)),{previewContainer:e,preview:t}}(),{buttons:w,visibilityMap:C}=createButtons(m,v),{selectedPointInfo:E,pointChartValues:b,pointDate:A}=function(){let e=el("div","point-info"),n=el("div","charts-info"),i=el("div");add(e,i,n);let l=Object.entries(m.names).reduce((e,[i,l])=>{let r=el("div","info");r.style.color=m.colors[i];let o=el("span");return e[i]=o,add(r,o,t(l)),add(n,r),e},{});return{selectedPointInfo:e,pointChartValues:l,pointDate:i}}(),{xAxes:M,xAxesHidden:k}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:$,yAxesGroupHidden:B}=function(){let e=svgEl("g",{},"y-axes"),t=svgEl("g",{},"y-axes","hidden");return[e,t].forEach(e=>{for(let t=0;t<u;t++)add(e,de(10,i-10,0,0),se("",5,0))}),{yAxesGroupShown:e,yAxesGroupHidden:t}}(),N=de(0,0,a,a+l);add(p,function(){let e=svgEl("g");return add(e,de(10,i-10,a,a),se("0",5,a+15)),e}(),N,$,B,M,k),add(v,p,y,w,E);let S=0,L=h.length,T=-1,D=0,F=0,j=m.columns,I=Q(),O=U(h,i),P=R(j),G=q(j),H=Z(S,L),_=te(H),z=null;function X(e,t){if(t===e)return;let n=Math.ceil(t*c/(u-1)),i=Array.apply(null,Array(u-1)).map((e,t)=>(t+1)*n),r=Y(i,le(i),l*c,a),o=B.childNodes;r.forEach((e,t)=>{svgAttrs(o[2*t],{y1:e,y2:e});let n=o[2*t+1];n.textContent=i[i.length-t-1],svgAttrs(n,{x:5,y:e-5})}),removeClass(B,"m-down","m-up"),removeClass($,"m-down","m-up"),addClass(B,t>e?"m-up":"m-down","pending"),addClass($,t>e?"m-down":"m-up","pending");let d=B;B=$,$=d,setTimeout(()=>{removeClass($,"hidden","pending"),removeClass(B,"pending"),addClass(B,"hidden")},0)}function V(){if(-1===T||T<S||T>L)return N.style.display="none",E.style.display="none",void ie(m.columns,(e,t)=>{m.lines[t].chartPoint.style.animationName="exit"});let e=h[T],t=i*(e-h[S])/(h[L-1]-h[S]);svgAttrs(N,{x1:t,x2:t}),ie(m.columns,(e,n)=>{let i=Y([e[T]],D,l,a)[0],r=m.lines[n].chartPoint;r.style.animationName=C[n]?"enter":"exit",svgAttrs(r,{cx:t});let o=r.firstChild;svgAttrs(o,{from:o.getAttribute("to"),to:i}),o.beginElement(),b[n].innerText=e[T],b[n].parentElement.style.display=C[n]?"flex":"none"}),A.innerText=new Date(e).toString().slice(0,10);let n=t>i/2;E.style[n?"right":"left"]=`${n?i-t:t}px`,E.style[n?"left":"right"]=null,E.style.display="block",N.style.display="block"}function q(e){return le(e.reduce((e,t)=>e.concat(t.data),[]))}function R(e){return le(e.reduce((e,t)=>e.concat(t.data.slice(S,L+1)),[]))}function W(e=!1){ie(j,(t,n)=>{K(m.lines[n],t),e&&J(m.lines[n],t)})}function J(e,t,n){let i=Y(t,G,r);!function(e,t,n,i=1){let l=e.firstChild,r=l.getAttribute("to")||t.reduce((e,t)=>e+`${t.toFixed(2)},0 `,"").trim(),o=t.reduce((e,t,i)=>e+`${t.toFixed(2)},${n[i].toFixed(2)} `,"").trim();svgAttrs(l,{from:r,to:o}),e.style.animationName=i?"enter":"exit",l.beginElement()}(e.preview,O,i,n)}function K(e,t,n){let i=t.slice(S,L+1),r=Y(i,P,l,a),o=Y(i,D,l,a);!function(e,t,n,i,l=1){let r=e.firstChild,o=t.reduce((e,t,n)=>e+`${t.toFixed(2)},${i[n]} `,""),d=t.reduce((e,t,i)=>e+`${t.toFixed(2)},${n[i].toFixed(2)} `,"").trim();svgAttrs(r,{from:o,to:d}),e.style.animationName=l?"enter":"exit",r.beginElement()}(e.chart,I,r,o,n)}function Q(){return U(h.slice(S,L+1),i)}function U(e,t){let n=e[0],i=e[e.length-1],l=Math.abs(i-n);return e.map(e=>t*(e-n)/l)}function Y(e,t,n,i=0){return e.map(e=>t?n*e/t+i:i)}function Z(e,t){let n=Math.round(10*(t-e)/h.length);return Math.round(Math.log2(n))}function ee(e){return Math.ceil(g*Math.pow(2,e))}function te(e){let t=[],n=ee(e);for(let e=0;e<h.length;e+=n)t.push(ne(h[e]));return t}function ne(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function ie(e,t){e.forEach(e=>t(e.data,e.name))}function le(e){return Math.max(...e)}function re(e="points"){return svgEl("animate",{attributeName:e,repeatCount:1,dur:"250ms",fill:"freeze",from:0,to:0})}function oe(e,t){return svgEl("polyline",{fill:"none",stroke:e,"stroke-width":t})}function de(e,t,n,i){return svgEl("line",{x1:e,y1:n,x2:t,y2:i,fill:"gray",stroke:"gray","stroke-width":.3})}function se(e,t,n){let i=svgEl("text",{x:t,y:n,"font-size":13});return i.textContent=e,i}ie(j,(e,t)=>{let n=m.colors[t],i=oe(n,o),l=oe(n,s),r=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":o});r.style.animationName="exit",m.lines[t]={chart:i,preview:l,chartPoint:r},add(i,re()),add(l,re()),add(r,re("cy")),add(p,i,r),add(x,l)}),add(n,v),W(!0),X(D,P),D=P,F=G,on(v,"visibility-updated",({detail:e})=>{C=e;let t=m.columns.filter(e=>C[e.name]);P=R(t),G=q(t),ie(t.length>j.length?t:j,(e,t)=>{let n=C[t]?1:0;K(m.lines[t],e,n),J(m.lines[t],e,n)}),X(D,P),D=P,F=G,j=t,V()}),on(v,"border-changed",({detail:{start:e,end:t}})=>{let n=Z(e,t);if(n!==H&&(_=te(n),function(e,t,n,i,l,r){let o=l!==r;if(n===i||!o){let n=M;M=k,k=n,addClass(M,"pending",o?"right":"",t>e?"even":""),removeClass(M,o?"":"right",t>e?"":"even"),addClass(k,o?"right":""),removeClass(k,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(M,"hidden"),addClass(k,"hidden")},0)}}(H,n,S,e,L,t),H=n),S=e,L=t,I=Q(),P=R(j),W(),!z){let e=D;z=setTimeout(()=>{X(e,P),z=null},100)}D=P,function(){!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(M);let e=ee(H),t=1;for(;(S+t)%e!=0;)t++;if((S+t)%(2*e)!=0){let n=(S+t-e)/(2*e),l=i*(h[n]-h[S])/(h[L]-h[S]),r=se(_[n],l,-2);add(M,r)}for(let n=t;n<I.length-1;n+=e){let t=se(_[(S+n)/e],I[n],-2);add(M,t)}}(),V()}),on(p,"click",e=>{let t=I[1]/2,n=S+Math.max(0,I.findIndex(n=>n+t>e.offsetX));n!==T&&(T=n,V())}),on(d,"click",e=>{v.contains(e.target)||(T=-1,V())})}let d=document;function el(e,...t){return addClass(d.createElement(e),...t)}function t(e){return d.createTextNode(e)}function svgEl(e,t,...n){let i=d.createElementNS("http://www.w3.org/2000/svg",e);return svgAttrs(i,t),addClass(i,...n)}function svgAttrs(e,t={}){Object.entries(t).forEach(([t,n])=>{e.setAttributeNS(null,t,n)})}function addClass(e,...t){return e.classList.add(...t.filter(e=>e)),e}function removeClass(e,...t){e.classList.remove(...t.filter(e=>e))}function add(e,...t){t.forEach(t=>e.appendChild(t))}function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function emit(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:n}))}function createSlider(e,t){let n,i=50,{slider:l,leftBar:r,rightBar:o}=function(){let e=el("div","slider"),t=el("div","slider__bar"),n=el("div","slider__bar","right");return add(e,t,n),{slider:e,leftBar:t,rightBar:n}}(),s=el("div","shadow","left"),a=el("div","shadow","right");on(t,"mousedown",v),on(t,"touchstart",v);let u,c,f,h=0,m=0,g={start:-1,end:-1};function v(e){let n=e.target,i=n===l?p:n===r||n===o?e=>(function(e,t){e.preventDefault();let n=y(e),i=f-n,l=t?Math.max(0,u-i):c,r=t?m:Math.max(0,h+i);w(l,r)&&(t?C(l):E(r),A())})(e,n===r):void 0;if(!i)return;f=y(e);let s=()=>{x(),off(t,"mousemove",i),off(t,"touchmove",i),off(d,"mouseup",s),off(d,"touchend",s)};on(t,"mousemove",i),on(t,"touchmove",i),on(d,"mouseup",s),on(d,"touchend",s)}function p(e){e.preventDefault();let t=y(e),n=f-t,i=u-n,l=h+n;w(i,l)&&(C(i),E(l),A())}function x(){w(c,m)&&(u=c,h=m)}function y(e){return e.touches?e.touches[0].clientX:e.clientX}function w(e,t){return e>=0&&t>=0&&n-e-t>=i}function C(e){c=e,b(s,e)}function E(e){m=e,b(a,e)}function b(e,t){e.style.width=`${t}px`}function A(){let i={start:Math.max(0,Math.round(c*e.length/n)),end:Math.min(e.length-1,Math.round((n-m)*(e.length-1)/n))};g.start===i.start&&g.end===i.end||(g=i,emit(t,"border-changed",i))}requestAnimationFrame(()=>{n=l.parentElement.getBoundingClientRect().width,c=n-i,E(m),C(c),x(),A()});let M=el("div","slider-container");return add(M,s,l,a),M}(()=>{let e="Switch to Night Mode",t="Switch to Day Mode",n=!1,i=d.getElementById("mode-switcher");on(i,"click",function(){d.body.classList.toggle("dark"),n=!n,i.innerText=n?t:e}),i.innerText=e})();