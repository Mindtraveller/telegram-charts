function createButtons(e,n){let i=el("div","buttons");on(i,"click",function(e){let t=e.target.dataset.chart;if(!t)return;let i={...l,[t]:!l[t]};if(!Object.values(i).some(e=>e))return;e.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",l=i)});let l=Object.keys(e.names).reduce((e,t)=>({...e,[t]:!0}),{});return Object.keys(e.names).forEach(n=>{let l=el("button"),r=svgEl("svg",{width:"20",height:"20",viewBox:"0 0 24 24"});r.style.borderColor=e.colors[n],r.style.background=e.colors[n],add(r,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}));let o=el("span");add(o,t(e.names[n])),add(l,r,o),l.dataset.chart=n,add(i,l)}),{buttons:i,visibilityMap:l}}function createChart(e){let n=d.getElementById("charts-container"),i=Math.min(500,window.innerWidth),l=400,r=50,o=2.5,a=1.5,s=20,c=5,u=.95,f=10*i/500,h=e.columns[0].slice(1),m={...e,columns:e.columns.slice(1).map(e=>({name:e[0],data:e.slice(1)})),lines:{}},g=Math.round(h.length/f/6),v=el("div","chart-wrapper"),p=svgEl("svg",{viewBox:`0 0 ${i} ${l+s}`}),{preview:x,previewContainer:y}=function(){let e=el("div","preview-container"),t=svgEl("svg",{viewBox:`0 0 ${i} ${r}`});return add(e,t,createSlider(h,v)),{previewContainer:e,preview:t}}(),{buttons:w,visibilityMap:C}=createButtons(m,v),{selectedPointInfo:E,pointChartValues:b,pointDate:M}=function(){let e=el("div","point-info"),n=el("div","charts-info"),i=el("div");add(e,i,n);let l=Object.entries(m.names).reduce((e,[i,l])=>{let r=el("div","info");r.style.color=m.colors[i];let o=el("span");return e[i]=o,add(r,o,t(l)),add(n,r),e},{});return{selectedPointInfo:e,pointChartValues:l,pointDate:i}}(),{xAxes:A,xAxesHidden:k}={xAxes:svgEl("g",{},"x-axes"),xAxesHidden:svgEl("g",{},"x-axes","hidden")},{yAxesGroupShown:B,yAxesGroupHidden:$}={yAxesGroupShown:svgEl("g",{},"y-axes"),yAxesGroupHidden:svgEl("g",{},"y-axes","hidden")},S=de(0,0,s,s+l);add(p,function(){let e=svgEl("g");return add(e,de(10,i-10,s,s),ce("0",5,s+15)),e}(),S,B,$,A,k),add(v,p,y,w,E);let L=0,N=h.length,T=-1,D=0,j=0,I=m.columns,O=Q(),P=U(h,i),G=R(I),H=F(I),_=te(L,N),X=ie(_),z=null;function V(e,t){if(t===e)return;let n=Math.ceil(t*u/(c-1)),r=Array.apply(null,Array(c-1)).map((e,t)=>(t+1)*n),o=Y(r,oe(r),l*u,s);Z($),o.forEach((e,t)=>{let n=de(10,i-10,e,e),l=ce(r[r.length-t-1],5,e-5);add($,n,l)}),removeClass($,"m-down","m-up"),removeClass(B,"m-down","m-up"),addClass($,t>e?"m-up":"m-down","pending"),addClass(B,t>e?"m-down":"m-up","pending");let a=$;$=B,B=a,setTimeout(()=>{removeClass(B,"hidden","pending"),removeClass($,"pending"),addClass($,"hidden")},0)}function q(){if(-1===T||T<L||T>N)return S.style.display="none",E.style.display="none",void re(m.columns,(e,t)=>{m.lines[t].chartPoint.style.animationName="exit"});let e=h[T],t=i*(e-h[L])/(h[N-1]-h[L]);svgAttrs(S,{x1:t,x2:t}),re(m.columns,(e,n)=>{let i=Y([e[T]],D,l,s)[0],r=m.lines[n].chartPoint;r.style.animationName=C[n]?"enter":"exit",svgAttrs(r,{cx:t});let o=r.firstChild;svgAttrs(o,{from:o.getAttribute("to"),to:i}),o.beginElement(),b[n].innerText=e[T],b[n].parentElement.style.display=C[n]?"flex":"none"}),M.innerText=new Date(e).toString().slice(0,10);let n=t>i/2;E.style[n?"right":"left"]=`${n?i-t:t}px`,E.style[n?"left":"right"]=null,E.style.display="block",S.style.display="block"}function F(e){return oe(e.reduce((e,t)=>e.concat(t.data),[]))}function R(e){return oe(e.reduce((e,t)=>e.concat(t.data.slice(L,N)),[]))}function W(e=!1){re(I,(t,n)=>{K(m.lines[n],t),e&&J(m.lines[n],t)})}function J(e,t,n){let i=Y(t,H,r),l=Y(t,j,r);ee(e.preview,P,i,l,n)}function K(e,t,n){let i=t.slice(L,N),r=Y(i,G,l,s),o=Y(i,D,l,s);ee(e.chart,O,r,o,n)}function Q(){return U(h.slice(L,N),i)}function U(e,t){let n=Math.min(...e),i=oe(e),l=Math.abs(i-n);return e.map(e=>t*(e-n)/l)}function Y(e,t,n,i=0){return e.map(e=>t?n*e/t+i:i)}function Z(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function ee(e,t,n,i,l=1){let r=e.firstChild;svgAttrs(r,{from:t.reduce((e,t,n)=>e+`${t},${i[n]} `,""),to:t.reduce((e,t,i)=>e+`${t},${n[i]} `,"")}),e.style.animationName=l?"enter":"exit",r.beginElement()}function te(e,t){let n=Math.round(10*(t-e)/h.length);return Math.round(Math.log2(n))}function ne(e){return Math.ceil(g*Math.pow(2,e))}function ie(e){let t=[],n=ne(e);for(let e=0;e<h.length;e+=n)t.push(le(h[e]));return t}function le(e){let t=new Date(e).toString().slice(4,10);return"0"===t[4]?`${t.slice(0,4)}${t[5]}`:t}function re(e,t){e.forEach(e=>t(e.data,e.name))}function oe(e){return Math.max(...e)}function ae(e="points"){return svgEl("animate",{attributeName:e,repeatCount:1,dur:"250ms",fill:"freeze",from:0,to:0})}function se(e,t){return svgEl("polyline",{fill:"none",stroke:e,"stroke-width":t})}function de(e,t,n,i){return svgEl("line",{x1:e,y1:n,x2:t,y2:i,fill:"gray",stroke:"gray","stroke-width":.3})}function ce(e,t,n){let i=svgEl("text",{x:t,y:n});return i.textContent=e,i}re(I,(e,t)=>{let n=m.colors[t],i=se(n,o),l=se(n,a),r=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":o});r.style.animationName="exit",m.lines[t]={chart:i,preview:l,chartPoint:r},add(i,ae()),add(l,ae()),add(r,ae("cy")),add(p,i,r),add(x,l)}),add(n,v),W(!0),V(D,G),D=G,j=H,on(v,"visibility-updated",({detail:e})=>{C=e;let t=m.columns.filter(e=>C[e.name]);G=R(t),H=F(t),re(t.length>I.length?t:I,(e,t)=>{let n=C[t]?1:0;K(m.lines[t],e,n),J(m.lines[t],e,n)}),V(D,G),D=G,j=H,I=t,q()}),on(v,"border-changed",({detail:{start:e,end:t}})=>{let n=te(e,t);if(n!==_&&(X=ie(n),function(e,t,n,i,l,r){let o=l!==r;if(n===i||!o){let n=A;A=k,k=n,addClass(A,"pending",o?"right":"",t>e?"even":""),removeClass(A,o?"":"right",t>e?"":"even"),addClass(k,o?"right":""),removeClass(k,"even",t>e?"pending":"",o?"":"right"),setTimeout(()=>{removeClass(A,"hidden"),addClass(k,"hidden")},0)}}(_,n,L,e,N,t),_=n),L=e,N=t,O=Q(),G=R(I),W(),!z){let e=D;z=setTimeout(()=>{V(e,G),z=null},100)}D=G,function(){Z(A);let e=ne(_),t=1;for(;(L+t)%e!=0;)t++;if((L+t)%(2*e)!=0){let n=(L+t-e)/(2*e),l=i*(h[n]-h[L])/(h[N]-h[L]),r=ce(X[n],l,0);add(A,r)}for(let n=t;n<O.length-1;n+=e){let t=ce(X[(L+n)/e],O[n],0);add(A,t)}}(),q()}),on(p,"click",e=>{let t=O[1]/2,n=L+Math.max(0,O.findIndex(n=>n+t>e.offsetX));n!==T&&(T=n,q())}),on(d,"click",e=>{v.contains(e.target)||(T=-1,q())})}let d=document;function el(e,...t){return addClass(d.createElement(e),...t)}function t(e){return d.createTextNode(e)}function svgEl(e,t,...n){let i=d.createElementNS("http://www.w3.org/2000/svg",e);return svgAttrs(i,t),addClass(i,...n)}function svgAttrs(e,t={}){Object.entries(t).forEach(([t,n])=>{e.setAttributeNS(null,t,n)})}function addClass(e,...t){return e.classList.add(...t.filter(e=>e)),e}function removeClass(e,...t){e.classList.remove(...t.filter(e=>e))}function add(e,...t){t.forEach(t=>e.appendChild(t))}function on(e,t,n){e.addEventListener(t,n)}function off(e,t,n){e.removeEventListener(t,n)}function emit(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:n}))}function createSlider(e,t){let n,i=50,{slider:l,leftBar:r,rightBar:o}=function(){let e=el("div","slider"),t=el("div","slider__bar"),n=el("div","slider__bar","right");return add(e,t,n),{slider:e,leftBar:t,rightBar:n}}(),a=el("div","shadow","left"),s=el("div","shadow","right");on(t,"mousedown",v),on(t,"touchstart",v);let c,u,f,h=0,m=0,g={start:-1,end:-1};function v(e){let n=e.target,i=n===l?p:n===r||n===o?e=>(function(e,t){e.preventDefault();let n=y(e),i=f-n,l=t?Math.max(0,c-i):u,r=t?m:Math.max(0,h+i);w(l,r)&&(t?C(l):E(r),M())})(e,n===r):void 0;if(!i)return;f=y(e);let a=()=>{x(),off(t,"mousemove",i),off(t,"touchmove",i),off(d,"mouseup",a),off(d,"touchend",a)};on(t,"mousemove",i),on(t,"touchmove",i),on(d,"mouseup",a),on(d,"touchend",a)}function p(e){e.preventDefault();let t=y(e),n=f-t,i=c-n,l=h+n;w(i,l)&&(C(i),E(l),M())}function x(){w(u,m)&&(c=u,h=m)}function y(e){return e.touches?e.touches[0].clientX:e.clientX}function w(e,t){return e>=0&&t>=0&&n-e-t>=i}function C(e){u=e,b(a,e)}function E(e){m=e,b(s,e)}function b(e,t){e.style.width=`${t}px`}function M(){let i={start:Math.max(0,Math.floor(u*e.length/n)),end:Math.min(e.length-1,Math.round((n-m)*e.length/n))};g.start===i.start&&g.end===i.end||(g=i,emit(t,"border-changed",i))}requestAnimationFrame(()=>{n=l.parentElement.getBoundingClientRect().width,u=n-i,E(m),C(u),x(),M()});let A=el("div","slider-container");return add(A,a,l,s),A}(()=>{let e="Switch to Night Mode",t="Switch to Day Mode",n=!1,i=d.getElementById("mode-switcher");on(i,"click",function(){d.body.classList.toggle("dark"),n=!n,i.innerText=n?t:e}),i.innerText=e})();