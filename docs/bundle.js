function createButtons(e,n){const s=addClass(el("div"),"buttons");on(s,"click",function(t){const e=t.target.dataset.chart;if(!e)return;const s={...o,[e]:!o[e]};if(!Object.values(s).some(t=>t))return;t.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",o=s)});let o=Object.keys(e.names).reduce((t,e)=>({...t,[e]:!0}),{});return Object.keys(e.names).forEach(n=>{const o=el("button"),i=svgEl("svg",{width:"20",height:"20",viewBox:"0 0 24 24"});i.style.borderColor=e.colors[n],i.style.background=e.colors[n],add(i,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"})),add(o,i);const d=el("span");add(d,t(e.names[n])),add(o,d),o.dataset.chart=n,add(s,o)}),{buttons:s,visibilityMap:o}}function createChart(e){const n=d.getElementById("charts-container"),s=Math.min(500,window.innerWidth),o=400,i=50,r=20,a=5,l=.95,c=10*s/500,u=e.columns[0].slice(1),f={...e,columns:e.columns.slice(1),lines:{}},h=Math.round(u.length/c/6),m=addClass(el("div"),"chart-wrapper"),g=svgEl("svg",{viewBox:`0 0 ${s} ${o+r}`}),{preview:v,previewContainer:p}=function(){const t=addClass(el("div"),"preview-container"),e=svgEl("svg",{viewBox:`0 0 ${s} ${i}`});return add(t,e),add(t,createSlider(f,m)),{previewContainer:t,preview:e}}();let{buttons:C,visibilityMap:x}=createButtons(f,m);const{selectedPointInfo:w,pointChartValues:y,pointDate:E}=function(){const e=el("div");addClass(e,"point-info");const n=el("div");addClass(n,"charts-info");const s=el("div");add(e,s),add(e,n);const o=Object.entries(f.names).reduce((e,[s,o])=>{const i=el("div");i.style.color=f.colors[s],addClass(i,"info");const d=el("span");return add(i,d),e[s]=d,add(i,t(o)),add(n,i),e},{});return{selectedPointInfo:e,pointChartValues:o,pointDate:s}}();let b,M,{xAxes:B,xAxesHidden:k}=function(){const t=svgEl("g");addClass(t,"x-axes");const e=svgEl("g");return addClass(e,"x-axes","hidden"),{xAxes:t,xAxesHidden:e}}();add(g,B),add(g,k),add(m,g),add(m,p),add(m,C),add(m,w),add(n,m);let A,$,L,N=0,S=void 0,D=-1,T=0,j=0,I=f.columns.filter(t=>x[t[0]]),O=K(),P=Q(u,s),_=R(I),X=F(I),z=tt(N,S),H=nt();function V(){if(_===T)return;const t=Math.ceil(_*l/(a-1)),e=Array.apply(null,Array(a-1)).map((e,n)=>(n+1)*t),n=U(e,it(e),o*l);Y(M),n.forEach((t,n)=>{const o=at(10,s-10,t+r,t+r),i=lt(e[e.length-n-1],5,t);add(M,o),add(M,i)}),removeClass(M,"m-down","m-up"),removeClass(b,"m-down","m-up"),addClass(M,_>T?"m-up":"m-down","pending"),addClass(b,_>T?"m-down":"m-up","pending");const i=M;M=b,b=i,setTimeout(()=>{removeClass(b,"hidden","pending"),removeClass(M,"pending"),addClass(M,"hidden")},0)}function q(){if(A&&(g.removeChild(A),A=null),-1===D)return w.style.display="none",void f.columns.forEach(t=>{const e=t[0];f.lines[e].chartPoint.style.animationName="exit"});const t=u[D],e=s*(t-u[N])/(u[S-1]-u[N]);A=at(e,e,r,r+o),f.columns.forEach(t=>{const n=t[0],s=t.slice(1),i=U(s,T,o,r),d=f.lines[n].chartPoint;d.style.animationName=x[n]?"enter":"exit",svgAttrs(d,{cx:e});const a=d.firstChild;svgAttrs(a,{from:a.getAttribute("to"),to:i[D]}),a.beginElement(),y[n].innerText=s[D],y[n].parentElement.style.display=x[n]?"flex":"none"}),g.insertBefore(A,g.firstChild),E.innerText=new Date(t).toString().slice(0,10);const n=e>s/2;w.style[n?"right":"left"]=`${n?s-e:e}px`,w.style[n?"left":"right"]=null,w.style.display="block"}function F(t){return it(t.reduce((t,e)=>t.concat(e.slice(1)),[]))}function R(t){return it(t.reduce((t,e)=>t.concat(e.slice(1+N,S?1+S:void 0)),[]))}function W(t=!1){ot(I,(e,n)=>{const s=e.slice(1);J(f.lines[n],s),t&&G(f.lines[n],s)})}function G(t,e,n){const s=U(e,X,i),o=U(e,j,i);Z(t.preview,P,s,o,n)}function J(t,e,n){const s=e.slice(N,S),i=U(s,_,o,r),d=U(s,T,o,r);Z(t.chart,O,i,d,n)}function K(){return Q(u.slice(N,S),s)}function Q(t,e){const n=Math.min(...t),s=it(t),o=Math.abs(s-n);return t.map(t=>e*(t-n)/o)}function U(t,e,n,s=0){return t.map(t=>e?n*t/e+s:s)}function Y(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Z(t,e,n,s,o=1){const i=t.firstChild;svgAttrs(i,{from:e.reduce((t,e,n)=>t+`${e},${s[n]} `,""),to:e.reduce((t,e,s)=>t+`${e},${n[s]} `,"")}),t.style.animationName=o?"enter":"exit",i.beginElement()}function tt(t,e=u.length){const n=Math.round(10*(e-t)/u.length);return Math.round(Math.log2(n))}function et(){return Math.ceil(h*Math.pow(2,z))}function nt(){const t=[],e=et();for(let n=0;n<u.length;n+=e)t.push(st(u[n]));return t}function st(t){const e=new Date(t).toString().slice(4,10);return"0"===e[4]?`${e.slice(0,4)}${e[5]}`:e}function ot(t,e){t.forEach(t=>e(t,t[0]))}function it(t){return Math.max(...t)}function dt(t="points"){return svgEl("animate",{attributeName:t,repeatCount:1,dur:"250ms",fill:"freeze",from:0,to:0})}function rt(t,e){return svgEl("polyline",{fill:"none",stroke:t,"stroke-width":e})}function at(t,e,n,s){return svgEl("line",{x1:t,y1:n,x2:e,y2:s,fill:"gray",stroke:"gray","stroke-width":.3})}function lt(t,e,n){const s=svgEl("text",{x:e,y:n});return s.textContent=t,s}ot(I,(t,e)=>{const n=f.colors[e],s=rt(n,2.5),o=rt(n,1.5),i=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":2.5});i.style.animationName="exit",f.lines[e]={chart:s,preview:o,chartPoint:i},add(s,dt()),add(o,dt()),add(i,dt("cy")),add(g,s),add(g,i),add(v,o)}),function(){const t=svgEl("g"),e=svgEl("g");addClass(t,"y-axes"),addClass(e,"y-axes","hidden"),g.insertBefore(t,g.firstChild),g.insertBefore(e,g.firstChild),g.insertBefore(function(){const t=svgEl("g"),e=at(10,s-10,r,r),n=lt("0",5,-r);return add(t,e),add(t,n),t}(),g.firstChild),b=t,M=e}(),W(!0),V(),T=_,j=X,on(m,"visibility-updated",({detail:t})=>{$=t,L=f.columns.filter(t=>$[t[0]]),_=R(L),X=F(L),ot(L.length>I.length?L:I,(t,e)=>{const n=t.slice(1),s=$[e]?1:0;J(f.lines[e],n,s),G(f.lines[e],n,s)}),V(),x=$,T=_,j=X,I=L,q()}),on(m,"border-changed",({detail:{start:t,end:e}})=>{const n=tt(t,e);n!==z&&(z=n,console.log(z),H=nt(),function(t,e,n,s){const o=t!==e,i=n!==s,d=n>s,r=B;B=k,k=r,addClass(B,"pending"),removeClass(B,"hidden","right"),addClass(k,"hidden"),removeClass(k,"pending","right"),!i||d||o||addClass(k,"right")}(N,t,S,e)),N=t,S=e,O=K(),_=R(I),W(),V(),function(){Y(B);const t=et();let e=1;for(;(N+e)%t!=0;)e++;for(let n=e;n<O.length-1;n+=t){const e=lt(H[(N+n)/t],O[n],0);add(B,e)}}(),T=_,q()}),on(g,"click",t=>{const e=t.offsetX,n=O[1]/2,s=N+Math.max(0,O.findIndex(t=>t+n>e));s!==D&&(D=s,q())}),on(d,"click",t=>{m.contains(t.target)||(D=-1,q())})}const d=document;function el(t){return d.createElement(t)}function t(t){return d.createTextNode(t)}function svgEl(t,e){const n=d.createElementNS("http://www.w3.org/2000/svg",t);return svgAttrs(n,e),n}function svgAttrs(t,e={}){Object.entries(e).forEach(([e,n])=>{t.setAttributeNS(null,e,n)})}function addClass(t,...e){return t.classList.add(...e),t}function removeClass(t,...e){t.classList.remove(...e)}function add(t,e){t.appendChild(e)}function on(t,e,n){t.addEventListener(e,n)}function off(t,e,n){t.removeEventListener(e,n)}function emit(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}function createSlider(t,e){const n=50,s=t.columns[0].slice(1),{slider:o,leftBar:i,rightBar:r}=function(){const t=addClass(el("div"),"slider"),e=addClass(el("div"),"slider__bar"),n=addClass(el("div"),"slider__bar","right");return add(t,e),add(t,n),{slider:t,leftBar:e,rightBar:n}}(),a=addClass(el("div"),"shadow","left"),l=addClass(el("div"),"shadow","right");let c;on(e,"mousedown",p),on(e,"touchstart",p);let u,f,h,m=0,g=0,v={start:-1,end:-1};function p(t){let n=t.target;const s=n===o?C:n===i||n===r?t=>(function(t,e){t.preventDefault();const n=w(t),s=h-n,o=e?Math.max(0,u-s):f,i=e?g:Math.max(0,m+s);y(o,i)&&(e?E(o):b(i),B())})(t,n===i):void 0;if(!s)return;h=w(t);const a=()=>{x(),off(e,"mousemove",s),off(e,"touchmove",s),off(d,"mouseup",a),off(d,"touchend",a)};on(e,"mousemove",s),on(e,"touchmove",s),on(d,"mouseup",a),on(d,"touchend",a)}function C(t){t.preventDefault();const e=w(t),n=h-e,s=u-n,o=m+n;y(s,o)&&(E(s),b(o),B())}function x(){y(f,g)&&(u=f,m=g)}function w(t){return t.touches?t.touches[0].clientX:t.clientX}function y(t,e){return t>=0&&e>=0&&c-t-e>=n}function E(t){f=t,M(a,t)}function b(t){g=t,M(l,t)}function M(t,e){t.style.width=`${e}px`}function B(){const t={start:Math.max(0,Math.floor(f*s.length/c)),end:Math.min(s.length-1,Math.round((c-g)*s.length/c))};v.start===t.start&&v.end===t.end||(v=t,emit(e,"border-changed",t))}requestAnimationFrame(()=>{c=o.parentElement.getBoundingClientRect().width,f=c-n,b(g),E(f),x(),B()});const k=addClass(el("div"),"slider-container");return add(k,a),add(k,o),add(k,l),k}(()=>{const t="Switch to Night Mode",e="Switch to Day Mode";let n=!1;const s=d.getElementById("mode-switcher");on(s,"click",function(){d.body.classList.toggle("dark"),n=!n,s.innerText=n?e:t}),s.innerText=t})();