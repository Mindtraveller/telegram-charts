function createButtons(e,n){const o=addClass(el("div"),"buttons");on(o,"click",function(t){const e=t.target.dataset.chart;if(!e)return;const o={...i,[e]:!i[e]};if(!Object.values(o).some(t=>t))return;t.target.classList.toggle("m-hidden"),emit(n,"visibility-updated",i=o)});let i=Object.keys(e.names).reduce((t,e)=>({...t,[e]:!0}),{});return Object.keys(e.names).forEach(n=>{const i=el("button"),s=svgEl("svg",{width:"24",height:"24",viewBox:"0 0 24 24"});s.style.borderColor=e.colors[n],s.style.background=e.colors[n],add(s,svgEl("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"})),add(i,s);const a=el("span");add(a,t(e.names[n])),add(i,a),i.dataset.chart=n,add(o,i)}),{buttons:o,visibilityMap:i}}function createChart(e){const n=document.getElementById("charts-container"),o=Math.min(500,window.innerWidth),i=400,s=Math.min(500,window.innerWidth),a=50,r=20,d=5,c=.95,l=10*o/500,u=e.columns[0].slice(1),f={...e,columns:e.columns.slice(1),lines:{}},h=Math.round(u.length/l/6),m=addClass(el("div"),"chart-wrapper"),g=svgEl("svg",{viewBox:`0 0 ${o} ${i+r}`}),{preview:v,previewContainer:p}=function(){const t=addClass(el("div"),"preview-container"),e=svgEl("svg",{viewBox:`0 0 ${s} ${a}`});return add(t,e),add(t,createSlider(f,m)),{previewContainer:t,preview:e}}();let{buttons:C,visibilityMap:w}=createButtons(f,m);const{selectedPointInfo:x,pointChartValues:E,pointDate:y}=function(){const e=el("div");addClass(e,"point-info-container");const n=el("div");addClass(n,"point-info__chart-info-container");const o=el("div");add(e,o),add(e,n);const i=Object.entries(f.names).reduce((e,[o,i])=>{const s=el("div");s.style.color=f.colors[o],addClass(s,"point-info__chart-info");const a=el("span");return add(s,a),e[o]=a,add(s,t(i)),add(n,s),e},{});return{selectedPointInfo:e,pointChartValues:i,pointDate:o}}();let M,b,{xAxes:B,xAxesHidden:k}=function(){const t=svgEl("g");addClass(t,"x-axes");const e=svgEl("g");return addClass(e,"x-axes","hidden"),{xAxes:t,xAxesHidden:e}}();add(g,B),add(g,k),add(m,g),add(m,p),add(m,C),add(m,x),add(n,m);let A,N,$,I=0,_=void 0,D=-1,L=0,T=0,X=f.columns.filter(t=>w[t[0]]),S=K(),P=Q(u,s),j=F(X),H=q(X),O=tt(I,_),W=nt();function z(){if(j===L)return;const t=Math.ceil(j*c/(d-1)),e=Array.apply(null,Array(d-1)).map((e,n)=>(n+1)*t),n=U(e,it(e),i*c);Y(b),n.forEach((t,n)=>{const i=rt(10,o-10,t+r,t+r),s=dt(e[e.length-n-1],5,t);add(b,i),add(b,s)}),removeClass(b,"m-down","m-up"),removeClass(M,"m-down","m-up"),addClass(b,j>L?"m-up":"m-down","pending"),addClass(M,j>L?"m-down":"m-up","pending");const s=b;b=M,M=s,setTimeout(()=>{removeClass(M,"hidden","pending"),removeClass(b,"pending"),addClass(b,"hidden")},0)}function V(){if(A&&(g.removeChild(A),A=null),-1===D)return x.style.display="none",void f.columns.forEach(t=>{const e=t[0];f.lines[e].chartPoint.style.animationName="exit"});const t=u[D],e=o*(t-u[I])/(u[_-1]-u[I]);A=rt(e,e,r,r+i),f.columns.forEach(t=>{const n=t[0],o=t.slice(1),s=U(o,L,i,r),a=f.lines[n].chartPoint;a.style.animationName=w[n]?"enter":"exit",svgAttrs(a,{cx:e});const d=a.firstChild;svgAttrs(d,{from:d.getAttribute("to"),to:s[D]}),d.beginElement(),E[n].innerText=o[D],E[n].parentElement.style.display=w[n]?"flex":"none"}),g.insertBefore(A,g.firstChild),y.innerText=new Date(t).toString().slice(0,10);const n=e>o/2;x.style[n?"right":"left"]=`${n?o-e:e}px`,x.style[n?"left":"right"]=null,x.style.display="block"}function q(t){return it(t.reduce((t,e)=>t.concat(e.slice(1)),[]))}function F(t){return it(t.reduce((t,e)=>t.concat(e.slice(1+I,_?1+_:void 0)),[]))}function R(t=!1){X.forEach(e=>{const n=e[0],o=e.slice(1);J(f.lines[n],o),t&&G(f.lines[n],o)})}function G(t,e,n){const o=U(e,H,a),i=U(e,T,a);Z(t.preview,P,o,i,n)}function J(t,e,n){const o=e.slice(I,_),s=U(o,j,i,r),a=U(o,L,i,r);Z(t.chart,S,s,a,n)}function K(){return Q(u.slice(I,_),o)}function Q(t,e){const n=Math.min(...t),o=it(t),i=Math.abs(o-n);return t.map(t=>e*(t-n)/i)}function U(t,e,n,o=0){return t.map(t=>e?n*t/e+o:o)}function Y(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Z(t,e,n,o,i=1){const s=t.firstChild;svgAttrs(s,{from:e.reduce((t,e,n)=>t+`${e},${o[n]} `,""),to:e.reduce((t,e,o)=>t+`${e},${n[o]} `,"")}),t.style.animationName=i?"enter":"exit",s.beginElement()}function tt(t,e=u.length){const n=Math.round(10*(e-t)/u.length);return Math.round(Math.log2(n))}function et(){return Math.ceil(h*Math.pow(2,O))}function nt(){const t=[],e=et();for(let n=0;n<u.length;n+=e)t.push(ot(u[n]));return t}function ot(t){const e=new Date(t).toString().slice(4,10);return"0"===e[4]?`${e.slice(0,4)}${e[5]}`:e}function it(t){return Math.max(...t)}function st(t="points"){return svgEl("animate",{attributeName:t,repeatCount:1,dur:"250ms",fill:"freeze"})}function at(t,e){return svgEl("polyline",{fill:"none",stroke:t,"stroke-width":e})}function rt(t,e,n,o){return svgEl("line",{x1:t,y1:n,x2:e,y2:o,fill:"gray",stroke:"gray","stroke-width":.3})}function dt(t,e,n){const o=svgEl("text",{x:e,y:n});return o.textContent=t,o}X.forEach(t=>{const e=t[0],n=f.colors[e],o=at(n,2.5),i=at(n,1.5),s=svgEl("circle",{r:6,fill:"white",stroke:n,"stroke-width":2.5});s.style.animationName="exit",f.lines[e]={chart:o,preview:i,chartPoint:s},add(o,st()),add(i,st()),add(s,st("cy")),add(g,o),add(g,s),add(v,i)}),function(){const t=svgEl("g"),e=svgEl("g");addClass(t,"y-axes"),addClass(e,"y-axes","hidden"),g.insertBefore(t,g.firstChild),g.insertBefore(e,g.firstChild),g.insertBefore(function(){const t=svgEl("g"),e=rt(10,o-10,r,r),n=dt("0",5,-r);return add(t,e),add(t,n),t}(),g.firstChild),M=t,b=e}(),R(!0),z(),L=j,T=H,on(m,"visibility-updated",({detail:t})=>{N=t,$=f.columns.filter(t=>N[t[0]]),j=F($),H=q($),($.length>X.length?$:X).forEach(t=>{const e=t[0],n=t.slice(1),o=N[e]?1:0;J(f.lines[e],n,o),G(f.lines[e],n,o)}),z(),w=N,L=j,T=H,X=$,V()}),on(m,"border-changed",({detail:{start:t,end:e}})=>{const n=tt(t,e);n!==O&&(O=n,console.log(O),W=nt(),function(t,e,n,o){const i=t!==e,s=n!==o,a=n>o,r=B;B=k,k=r,addClass(B,"pending"),removeClass(B,"hidden","right"),addClass(k,"hidden"),removeClass(k,"pending","right"),!s||a||i||addClass(k,"right")}(I,t,_,e)),I=t,_=e,S=K(),j=F(X),R(),z(),function(){Y(B);const t=et();let e=1;for(;(I+e)%t!=0;)e++;for(let n=e;n<S.length-1;n+=t){const e=dt(W[(I+n)/t],S[n],0);add(B,e)}}(),L=j,V()}),on(g,"click",t=>{const e=t.offsetX,n=S[1]/2,o=I+Math.max(0,S.findIndex(t=>t+n>e));o!==D&&(D=o,V())}),on(document,"click",t=>{m.contains(t.target)||(D=-1,V())})}function el(t){return document.createElement(t)}function t(t){return document.createTextNode(t)}function svgEl(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return svgAttrs(n,e),n}function svgAttrs(t,e={}){Object.entries(e).forEach(([e,n])=>{t.setAttributeNS(null,e,n)})}function addClass(t,...e){return t.classList.add(...e),t}function removeClass(t,...e){t.classList.remove(...e)}function add(t,e){t.appendChild(e)}function on(t,e,n){t.addEventListener(e,n)}function off(t,e,n){t.removeEventListener(e,n)}function emit(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}(()=>{const t="Switch to Night Mode",e="Switch to Day Mode";let n=!1;const o=document.getElementById("mode-switcher");on(o,"click",function(){document.body.classList.toggle("dark-mode"),n=!n,o.innerText=n?e:t}),o.innerText=t})();const MIN_WIDTH=50;function createSlider(t,e){const n=t.columns[0].slice(1),{slider:o,leftBar:i,rightBar:s}=function(){const t=addClass(el("div"),"slider"),e=addClass(el("div"),"slider__bar"),n=addClass(el("div"),"slider__bar","right");return add(t,e),add(t,n),{slider:t,leftBar:e,rightBar:n}}(),a=A("left"),r=A("right");let d;on(i,"touchstart",C),on(i,"mousedown",C),on(o,"touchstart",g),on(o,"mousedown",g),on(s,"touchstart",C),on(s,"mousedown",C);let c,l,u,f=0,h=0,m={start:-1,end:-1};function g(t){u=t.touches?t.touches[0].clientX:t.clientX,on(t.target,"touchmove",v),on(t.target.parentElement,"mousemove",v),on(t.target,"touchend",p),window.onmouseup=(()=>p(t))}function v(t){t.preventDefault();const e=t.touches?t.touches[0].clientX:t.clientX,n=u-e,o=Math.max(0,c-n),i=Math.max(0,f+n);y(o,i)&&(M(o),b(i),k())}function p(t){E(),off(t.target,"touchmove",v),off(t.target.parentElement,"mousemove",v),off(t.target,"touchend",p),window.onmouseup=void 0}function C(t){u=t.touches?t.touches[0].clientX:t.clientX;const e=t.target===i;t.target.ontouchmove=(t=>w(t,e)),t.target.parentElement.parentElement.onmousemove=(t=>w(t,e)),on(t.target,"touchend",x),window.onmouseup=(()=>x(t)),t.stopPropagation()}function w(t,e){t.preventDefault();const n=t.touches?t.touches[0].clientX:t.clientX,o=u-n,i=e?Math.max(0,c-o):l,s=e?h:Math.max(0,f+o);y(i,s)&&(e?M(i):b(s),k())}function x(t){E(),t.target.onmousemove=void 0,t.target.parentElement.parentElement.onmousemove=void 0,off(t.target,"touchend",x),window.onmouseup=void 0}function E(){y()&&(f=h,c=l)}function y(t=l,e=h){return d-t-e>=MIN_WIDTH}function M(t){l=t,B(a,t)}function b(t){h=t,B(r,t)}function B(t,e){t.style.width=`${e}px`}function k(){const t={start:Math.max(0,Math.floor(l*n.length/d)),end:Math.min(n.length-1,Math.round((d-h)*n.length/d))};m.start===t.start&&m.end===t.end||(m=t,emit(e,"border-changed",t))}function A(t){return addClass(el("div"),"shadow",t)}requestAnimationFrame(()=>{d=o.parentElement.getBoundingClientRect().width,l=d-MIN_WIDTH,b(h),M(l),E(),k()});const N=addClass(el("div"),"slider-container");return add(N,a),add(N,o),add(N,r),N}